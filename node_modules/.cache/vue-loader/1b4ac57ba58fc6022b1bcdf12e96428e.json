{"remainingRequest":"E:\\网络招聘大数据分析与可视化系统\\jobData_Analysis前端\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\网络招聘大数据分析与可视化系统\\jobData_Analysis前端\\src\\map\\components\\MapView.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"E:\\网络招聘大数据分析与可视化系统\\jobData_Analysis前端\\src\\map\\components\\MapView.vue","mtime":1580909947262},{"path":"E:\\网络招聘大数据分析与可视化系统\\jobData_Analysis前端\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"E:\\网络招聘大数据分析与可视化系统\\jobData_Analysis前端\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\网络招聘大数据分析与可视化系统\\jobData_Analysis前端\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\网络招聘大数据分析与可视化系统\\jobData_Analysis前端\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1580901136398},{"path":"E:\\网络招聘大数据分析与可视化系统\\jobData_Analysis前端\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.main .container-fluid {\n  padding: 0 0px;\n}\n.breadcrumb {\n  position: relative;\n  margin-bottom: 0.01rem;\n  border-bottom: 1px solid #cfd8dc;\n}\n#layerToggle {\n  top: 20px;\n  right: 20px;\n  position: absolute;\n  z-index: 99;\n  background-color: white;\n  border-radius: 8px;\n  padding: 10px;\n  opacity: 0.75;\n}\n.baidu {\n  position: absolute;\n  right: 0;\n  top: 115px;\n}\n\n.list-wrapper {\n  padding: 10px;\n  overflow-y: auto;\n}\n",{"version":3,"sources":["MapView.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"MapView.vue","sourceRoot":"src\\map\\components","sourcesContent":["<template>\n  <div>\n    <div id=\"viewDiv\" region=\"center\">\n      <div class=\"tools\">\n        <MapToolsView :mapView=\"mapview\" v-if=\"IsMapToolsView\" :url=\"toolsUrl\"></MapToolsView>\n      </div>\n      <div class=\"mapbar\">\n        <ul>\n          <li class=\"btn\">\n            <span class=\"icon baseLayer\" @click=\"switch3d\"></span>\n            <span>3D</span>\n          </li>\n          <li id=\"switchbasemap\" @click=\"switchbasemap\">\n            <span class=\"icon baseLayerImg\"></span>\n            <span>影像</span>\n          </li>\n          <li class=\"btn\" :class=\"{layerActive:isLayerViewShow}\" @click=\"onControlLayerView\">\n            <span class=\"icon layerView\"></span>\n            <span>图层</span>\n          </li>\n          <!-- <map-layer-view ref=\"layerView\" style=\"margin-left:35px;\" :mapView=\"mapView\" :layerOpt=\"layerList\" :isOut=\"true\"></map-layer-view> -->\n        </ul>\n      </div>\n\n    </div>\n  </div>\n</template><script>\nimport esriLoader from \"esri-loader\";\nimport { MapAPI } from \"@/core/config/const\";\nimport Register from \"@/map/api/register\";\nimport Server from \"@/core/server\";\nimport { services } from \"@/core/config/services\";\nimport measureArea from \"@/map/components/measureArea\";\nimport measureLength from \"@/map/components/measureLength\";\nimport MapToolsView from \"@/map/components/MapToolsView\";\nimport GDrawSketch from \"@/map/api/4+/GDrawSketch\";\nimport GConvertGeometry from \"@/map/api/js/convert/GConvertGeometry\";\nimport MapLayerView from \"./MapLayerView\";\nexport default {\n  data() {\n    return {\n      visible: false,\n      isShow: false,\n      shape: \"\",\n      txt_input: \"\",\n      list: [],\n      dialog: false,\n      pageSize: 10,\n      txt_select: \"\",\n      data: [],\n      baseLayer: \"\",\n      street: \"\",\n      isExtent: true,\n      isPopup: true,\n      isPan: true,\n      defaultMapExtent: \"13175030.812,3804452.901,3\",\n      spatialReference: \"\",\n      toolsUrl: \"js/json/common_tools.json\",\n      mapTileLayerLayers: \"\",\n      TileLayerStreets: \"\",\n      MapImageLayer: \"\",\n      mapview: null,\n      IsMapToolsView: false,\n      isLayerViewShow: false\n    };\n  },\n  computed: {\n    height() {\n      return document.body.clientHeight - 200;\n    }\n  },\n  watch: {\n    data() {\n      this.onPageChange(1);\n    }\n  },\n  mounted() {\n    this.spatialReference = \"\";\n    this.addLayer(mapView => {\n      this.mapLoaded(mapView);\n    });\n    this.register();\n    // setTimeout(() => {\n    //   this.showGraphics();\n    // }, 600);\n  },\n  methods: {\n    onControlLayerView() {\n      this.isLayerViewShow = !this.isLayerViewShow;\n      debugger;\n      // this.$refs.layerView.showLayerView();\n    },\n    switch3d() {\n      this.$router.push(\"/3dmap\");\n    },\n    register() {\n      //接收外部结果\n      onemap.pubsub.subscribe(\"showQuickSearchResult\", arg => {\n        this.isExtent = false;\n        this.isPan = false;\n        this.isPopup = arg.isPopup || true;\n        this.data = arg.list;\n        this.visible = true;\n      });\n      onemap.pubsub.subscribe(\"hideQuickSearchResult\", arg => {\n        this.visible = false;\n        this.data = [];\n      });\n\n      //clear\n      onemap.pubsub.subscribe(\"clear\", arg => {\n        this.visible = false;\n        this.data = [];\n      });\n    },\n    mapLoaded(mapView) {\n      new Register(mapView)\n        .mapEvent()\n        .mapAPI()\n        .parentMapAPI();\n      if (this.isIQuery) {\n        new GIQuery({\n          mapView: mapView,\n          isPopup: this.isIPopup\n        }).toggle();\n      }\n    },\n    onToggleLayer() {\n      if (document.getElementsByClassName) {\n        var target = document.getElementsByClassName(\"esri-layer-list\");\n        var targetName = target[0];\n        if (targetName.style.display == \"block\") {\n          targetName.style.display = \"none\";\n        } else {\n          targetName.style.display = \"block\";\n        }\n      }\n    },\n\n    addLayer(callback) {\n      esriLoader\n        .loadScript({\n          url: MapAPI.js,\n          css: MapAPI.css\n        })\n        .then(r => {\n          esriLoader\n            .loadModules([\n              \"esri/config\",\n              \"esri/Map\",\n              \"esri/layers/GroupLayer\",\n              \"esri/Basemap\",\n              \"esri/views/MapView\",\n              \"esri/layers/MapImageLayer\",\n              \"esri/layers/TileLayer\",\n              \"esri/geometry/Extent\",\n              \"esri/widgets/LayerList\"\n            ])\n            .then(\n              ([\n                esriConfig,\n                Map,\n                GroupLayer,\n                Basemap,\n                MapView,\n                MapImageLayer,\n                TileLayer,\n                Extent,\n                LayerList,\n                dom,\n                on\n              ]) => {\n                // esriConfig.request.corsEnabledServers.push(\"192.168.1.102/\");\n\n                var activeWidget = null;\n                var layer = new TileLayer({\n                  url:\n                    \"http://122.112.216.247:6080/arcgis/rest/services/Server/MAP/MapServer\"\n                });\n                this.baseLayer = layer;\n\n                var baseMap = new Basemap({\n                  baseLayers: [layer]\n                });\n\n                var map = new Map({\n                  basemap: baseMap\n                });\n                var ext = String(this.defaultMapExtent).split(\",\");\n                if (ext.length > 3) {\n                  console.log(\"extent 配置有误\");\n                  return false;\n                }\n                var zoom = parseInt(ext[2]);\n                var center = {\n                  x: parseFloat(ext[0]),\n                  y: parseFloat(ext[1]),\n                  spatialReference: this.spatialReference\n                };\n                this.mapview = new MapView({\n                  container: \"viewDiv\",\n                  map: map,\n                  zoom: zoom,\n                  center: center\n                });\n\n                this.mapview.ui.remove([\"attribution\", \"zoom\"]);\n                var view = this.mapview;\n                view.when(function() {\n                  var layerList = new LayerList({\n                    view: view\n                  });\n                  view.ui.add(layerList, \"top-right\");\n                });\n\n                this.mapview.initExtent = {\n                  center: center,\n                  zoom: zoom\n                };\n                window.mapview = this.mapview;\n                callback(this.mapview);\n                this.IsMapToolsView = true;\n              }\n            );\n        });\n    },\n    switchbasemap() {\n      if (this.baseLayer.visible) {\n        this.baseLayer.visible = false;\n        this.street.visible = true;\n      } else {\n        this.baseLayer.visible = true;\n        this.street.visible = false;\n      }\n    },\n    watchLayer() {}\n  },\n  components: {\n    measureArea,\n    measureLength,\n    MapToolsView,\n    MapLayerView\n  }\n};\n</script>\n\n<style >\n\n.main .container-fluid {\n  padding: 0 0px;\n}\n.breadcrumb {\n  position: relative;\n  margin-bottom: 0.01rem;\n  border-bottom: 1px solid #cfd8dc;\n}\n#layerToggle {\n  top: 20px;\n  right: 20px;\n  position: absolute;\n  z-index: 99;\n  background-color: white;\n  border-radius: 8px;\n  padding: 10px;\n  opacity: 0.75;\n}\n.baidu {\n  position: absolute;\n  right: 0;\n  top: 115px;\n}\n\n.list-wrapper {\n  padding: 10px;\n  overflow-y: auto;\n}\n</style>"]}]}