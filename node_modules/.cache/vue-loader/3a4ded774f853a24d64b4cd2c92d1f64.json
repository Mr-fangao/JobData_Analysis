{"remainingRequest":"D:\\graduate\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\graduate\\src\\views\\spaceRecommendation\\spaceRecommendation.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\graduate\\src\\views\\spaceRecommendation\\spaceRecommendation.vue","mtime":1584791162788},{"path":"D:\\graduate\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\graduate\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\graduate\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\graduate\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1580901136398},{"path":"D:\\graduate\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* .ivu-input {\n    display: inline-block;\n    width: 80%;\n    height: 32px;\n    line-height: 1.5;\n    padding: 4px 7px;\n    font-size: 12px;\n    border: 1px solid #dcdee2;\n    border-radius: 4px;\n    color: #515a6e;\n    background-color: #fff;\n    background-image: none;\n    position: relative;\n    cursor: text;\n    transition: border .2s ease-in-out,background .2s ease-in-out,box-shadow .2s ease-in-out;\n} */\n",{"version":3,"sources":["spaceRecommendation.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"spaceRecommendation.vue","sourceRoot":"src\\views\\spaceRecommendation","sourcesContent":["<template>\n  <div id=\"viewDiv\" region=\"center\">\n    <div class=\"tools\">\n      <MapToolsView :mapView=\"mapview\" v-if=\"IsMapToolsView\" :url=\"toolsUrl\"></MapToolsView>\n    </div>\n    <Modal v-model=\"dialog2\" :mask-closable=\"false\" width=\"400\" title=\"缓冲区查询\" draggable>\n      <Form :label-width=\"60\">\n        <FormItem label=\"半径：\" prop=\"zoning\" :width=\"80\">\n          <div style=\"width:260px ;display:inline-block\">\n            <Input v-model=\"distance\" placeholder clearable></Input>\n          </div>\n          <span style=\"width:20px;margin-left:15px\">千米</span>\n        </FormItem>\n        <FormItem label=\"选点：\" prop=\"zoning\">\n          <Button shape=\"circle\" title=\"自定义选点\" @click=\"createPoint\">\n            <span>\n              <Icon type=\"ios-pin-outline\" size=\"17\" />\n            </span>\n          </Button>\n        </FormItem>\n      </Form>\n      <div slot=\"footer\">\n        <Button type=\"primary\" size=\"large\" long @click=\"getHouse\">查询</Button>\n      </div>\n    </Modal>\n  </div>\n</template>\n <script>\nimport MapToolsView from \"@/map/components/MapToolsView\";\nimport Server from \"@/core/server\";\nimport { services } from \"@/core/config/services\";\nimport GDrawSketch from \"@/map/api/4+/GDrawSketch\";\nimport GDrawbuffer from \"@/map/api/4+/GDrawBuffer\";\nimport GConvertGeometry from \"@/map/api/js/convert/GConvertGeometry\";\nexport default {\n  components: {\n    measureArea,\n    measureLength,\n    MapToolsView,\n    Item,\n    MapLayerView\n  },\n  created() {\n    this.$root.Bus.$on(\"eventSelectBuffer\", () => {\n      this.dialog2 = true;\n    });\n  },\n  data() {\n    return {\n      IsMapToolsView: false,\n      dialog2: false,\n      house: \"\",\n      isExtent: true,\n      isPopup: true,\n      isPan: true,\n      list: \"\",\n      distance: \"\"\n    };\n  },\n  methods: {\n    getHouse() {\n      debugger;\n      Server.post({\n        url: services.getHouse,\n        params: {\n          housePolygon: this.house\n        }\n      }).then(rsp => {\n        if (rsp.status === 1) {\n          this.list = rsp.data;\n          this.showGraphics();\n          this.$Message.success(\"查询成功\");\n          // sessionStorage.setItem(\"userInfo\", JSON.stringify(this.user))\n        } else {\n          this.$Message.error(rsp.message);\n        }\n      });\n    },\n    createPoint() {\n      new GDrawbuffer(window.mapview).then(gDraw => {\n        this.gDraw = gDraw;\n        this.gDraw.enableCreatePoint(this.distance, buffer => {\n          this.house = window.mapApi.convert.toWKTByGeometry.ToWKT(buffer);\n          console.log(buffer.centroid.latitude);\n          console.log(buffer.centroid.longitude);\n          console.log(buffer.centroid.x);\n          console.log(buffer.centroid.y);\n        });\n        // console.log(shape1);\n        // var buffer = this.gDraw.enableCreatePoint(this.distance);\n        // console.log(buffer);\n        // console.log(this.gDraw);\n        // this.gDraw.on(\"draw-complete\", e => {\n        //   // let shape = mapApi.convert.toWKTByGeometry.ToWKT(e.geometry);\n        //   // this.shape = shape;\n        //   // console.log(this.shape);\n        //   // parent.onemap.pubsub.publish(\"drawPolygon\", shape);\n        // });\n      });\n    },\n    showGraphics() {\n      //render graphic\n\n      if (this.list === 0) return;\n      onemap.pubsub.publish(\"drawHouseByList\", {\n        list: this.list,\n        popup: this.isPopup,\n        pan: this.isPan\n      });\n    },\n    addLayer(callback) {\n      esriLoader\n        .loadScript({\n          url: MapAPI.js,\n          css: MapAPI.css\n        })\n        .then(r => {\n          esriLoader\n            .loadModules([\n              \"esri/config\",\n              \"esri/Map\",\n              \"esri/layers/GroupLayer\",\n              \"esri/Basemap\",\n              \"esri/views/MapView\",\n              \"esri/layers/MapImageLayer\",\n              \"esri/layers/TileLayer\",\n              \"esri/geometry/Extent\",\n              \"esri/widgets/LayerList\"\n            ])\n            .then(\n              ([\n                esriConfig,\n                Map,\n                GroupLayer,\n                Basemap,\n                MapView,\n                MapImageLayer,\n                TileLayer,\n                Extent,\n                LayerList,\n                dom,\n                on\n              ]) => {\n                // esriConfig.request.corsEnabledServers.push(\"122.112.216.247/\");\n\n                var activeWidget = null;\n\n                var layer = new TileLayer({\n                  url:\n                    \"http://localhost:6080/arcgis/rest/services/chouz/Map/MapServer\"\n                });\n                this.baseLayer = layer;\n\n                // var street = new TileLayer({\n                //   url:\n                //     \"https://localhost:6443/arcgis/rest/services/ChuZhou/ChuZhouYX/MapServer\",\n                //   visible: false\n                // });\n\n                // this.street = street;\n                // var USALayer = new MapImageLayer({\n                //   url:\n                //     \"http://122.112.216.247:6080/arcgis/rest/services/CHUZHOU/odqllj/MapServer\",\n                //   title: \"od成本\",\n                //   visible: false\n                // });\n\n                // var censusLayer = new MapImageLayer({\n                //   url:\n                //     \"http://122.112.216.247:6080/arcgis/rest/services/CHUZHOU/zhonguexuequ/MapServer\",\n                //   title: \"学区数据\",\n                //   opacity: 0.8,\n                //   visible: false\n                // });\n                var baseMap = new Basemap({\n                  baseLayers: [layer]\n                });\n                // var demographicGroupLayer = new GroupLayer({\n                //   title: \"专题图层\",\n                //   visible: true,\n                //   visibilityMode: \"independent\",\n                //   layers: [USALayer, censusLayer]\n                //   //\n                // });\n\n                var map = new Map({\n                  basemap: baseMap\n                  // layers: [demographicGroupLayer]\n                });\n                var ext = String(this.defaultMapExtent).split(\",\");\n\n                if (ext.length > 3) {\n                  console.log(\"extent 配置有误\");\n                  return false;\n                }\n                var zoom = parseInt(ext[2]);\n                var center = {\n                  x: parseFloat(ext[0]),\n                  y: parseFloat(ext[1]),\n                  spatialReference: this.spatialReference\n                };\n                this.mapview = new MapView({\n                  container: \"viewDiv\",\n                  map: map,\n                  zoom: zoom,\n                  center: center\n                });\n                this.mapview.ui.remove([\"attribution\", \"zoom\"]);\n                var view = this.mapview;\n                // view.when(function() {\n                //   var layerList = new LayerList({\n                //     view: view\n                //   });\n                //   view.ui.add(layerList, \"top-right\");\n                // });\n\n                this.mapview.initExtent = {\n                  center: center,\n                  zoom: zoom\n                };\n                window.mapview = this.mapview;\n                callback(this.mapview);\n                this.IsMapToolsView = true;\n              }\n            );\n        });\n    }\n  },\n  beforeDestroy() {\n    this.$root.Bus.$off(\"eventSelectBuffer\");\n  }\n};\n</script>\n<style >\n/* .ivu-input {\n    display: inline-block;\n    width: 80%;\n    height: 32px;\n    line-height: 1.5;\n    padding: 4px 7px;\n    font-size: 12px;\n    border: 1px solid #dcdee2;\n    border-radius: 4px;\n    color: #515a6e;\n    background-color: #fff;\n    background-image: none;\n    position: relative;\n    cursor: text;\n    transition: border .2s ease-in-out,background .2s ease-in-out,box-shadow .2s ease-in-out;\n} */\n</style>\n\n "]}]}