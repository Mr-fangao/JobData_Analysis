{"remainingRequest":"C:\\Users\\asus\\Desktop\\GIS相关比赛\\01 GIS省赛(中期检查+收尾)\\04 系统运行代码\\Code\\前端\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\asus\\Desktop\\GIS相关比赛\\01 GIS省赛(中期检查+收尾)\\04 系统运行代码\\Code\\前端\\src\\views\\spaceRecommendation\\index.vue?vue&type=style&index=0&id=45d51f78&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\asus\\Desktop\\GIS相关比赛\\01 GIS省赛(中期检查+收尾)\\04 系统运行代码\\Code\\前端\\src\\views\\spaceRecommendation\\index.vue","mtime":1588970980807},{"path":"C:\\Users\\asus\\Desktop\\GIS相关比赛\\01 GIS省赛(中期检查+收尾)\\04 系统运行代码\\Code\\前端\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\asus\\Desktop\\GIS相关比赛\\01 GIS省赛(中期检查+收尾)\\04 系统运行代码\\Code\\前端\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\asus\\Desktop\\GIS相关比赛\\01 GIS省赛(中期检查+收尾)\\04 系统运行代码\\Code\\前端\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\asus\\Desktop\\GIS相关比赛\\01 GIS省赛(中期检查+收尾)\\04 系统运行代码\\Code\\前端\\node_modules\\less-loader\\dist\\cjs.js","mtime":1580901133496},{"path":"C:\\Users\\asus\\Desktop\\GIS相关比赛\\01 GIS省赛(中期检查+收尾)\\04 系统运行代码\\Code\\前端\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1580901136398},{"path":"C:\\Users\\asus\\Desktop\\GIS相关比赛\\01 GIS省赛(中期检查+收尾)\\04 系统运行代码\\Code\\前端\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.info {\r\n  position: absolute;\r\n  border: 1px solid #dcdee2;\r\n  background-color: #fff;\r\n  border-color: #e8eaec;\r\n  height: 670px;\r\n  overflow-y: scroll;\r\n  width: 380px;\r\n  padding: 5px;\r\n  right: 0;\r\n  top: 40px;\r\n  z-index: 99;\r\n}\r\n.itemImage {\r\n  height: 80px;\r\n  width: 130px;\r\n}\r\n.sidermenu {\r\n  justify-content: space-between;\r\n  background-color: #fcf9f2;\r\n  border-radius: 5px;\r\n  align-items: center;\r\n  display: flex;\r\n  width: 350px;\r\n  position: absolute;\r\n  border: 1px solid #dcdee2;\r\n  border-color: #e8eaec;\r\n  padding: 5px;\r\n  left: 40px;\r\n  top: 48px;\r\n  transition: all 0.2s ease-in-out;\r\n  z-index: 9999;\r\n}\r\n.kjcx {\r\n  display: block;\r\n}\r\n.ivu-layout-sider {\r\n  height: 300px;\r\n  transition: all 0.2s ease-in-out;\r\n  position: relative;\r\n  background: #fff;\r\n  min-width: 0;\r\n}\r\n.ivu-form-item {\r\n  margin-bottom: 12px;\r\n  vertical-align: top;\r\n  zoom: 1;\r\n}\r\n.menu-item-title {\r\n  height: 48px;\r\n  line-height: 48px;\r\n  font-size: 14px;\r\n  padding-left: 28px;\r\n}\r\n.layout {\r\n  height: 670px;\r\n  background: #f5f7f9;\r\n  position: relative;\r\n  border-radius: 4px;\r\n  overflow: hidden;\r\n}\r\n\r\n.layout-header-bar {\r\n  background: #fcf9f2;\r\n  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);\r\n}\r\n.layout-logo-left {\r\n  width: 90%;\r\n  height: 30px;\r\n  border-radius: 3px;\r\n  margin: 15px auto;\r\n}\r\n.menu-icon {\r\n  transition: all 0.3s;\r\n}\r\n.rotate-icon {\r\n  transform: rotate(-90deg);\r\n}\r\n.menu-item span {\r\n  display: inline-block;\r\n  overflow: hidden;\r\n  width: 69px;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  vertical-align: bottom;\r\n  transition: width 0.2s ease 0.2s;\r\n}\r\n.menu-item i {\r\n  transform: translateX(0px);\r\n  transition: font-size 0.2s ease, transform 0.2s ease;\r\n  vertical-align: middle;\r\n  font-size: 16px;\r\n}\r\n.collapsed-menu span {\r\n  width: 0px;\r\n  transition: width 0.2s ease;\r\n}\r\n.collapsed-menu i {\r\n  transform: translateX(5px);\r\n  transition: font-size 0.2s ease 0.2s, transform 0.2s ease 0.2s;\r\n  vertical-align: middle;\r\n  font-size: 22px;\r\n}\r\n.siderItem {\r\n  margin-left: 1px;\r\n}\r\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src\\views\\spaceRecommendation","sourcesContent":["<template>\r\n  <div class=\"layout\">\r\n    <Layout>\r\n      <Content>\r\n        <Header :style=\"{padding: 0}\" class=\"layout-header-bar\">\r\n          <Breadcrumb>\r\n            <Icon :style=\"{margin: '0 5px'}\" type=\"md-menu\" size=\"25\"></Icon>\r\n            <BreadcrumbItem\r\n              v-for=\"(item,idx) in $route.matched\"\r\n              :key=\"idx\"\r\n              :to=\"(item.path)\"\r\n            >{{item.name}}</BreadcrumbItem>\r\n          </Breadcrumb>\r\n        </Header>\r\n        <div class=\"info\">\r\n          <div v-for=\"(value,index) in list\" :key=\"index\">\r\n            <div @click=\"location(index,value)\" style=\"margin: 10px;border-bottom:1px solid #999\">\r\n              <Row>\r\n                <Col span=\"12\">\r\n                  <div class=\"left mend_img\">\r\n                    <img style=\"width: 150px;height: 100px\" v-bind:src=\"value.image\" />\r\n                  </div>\r\n                </Col>\r\n                <Col span=\"12\">\r\n                  <div class=\"left name\" style=\"margin-top: 5px\">\r\n                    <h3 style=\"display:inline-block;width:140px\">{{value.name}}</h3>\r\n                    <img\r\n                      v-if=\"value.collected == '0'\"\r\n                      :src=\"uncollect\"\r\n                      alt\r\n                      title=\"收藏\"\r\n                      @click=\"Collection(index,value)\"\r\n                      id=\"index\"\r\n                      style=\"width: 15px;height: 15px;\"\r\n                    />\r\n                    <img\r\n                      v-else-if=\"value.collected == '1'\"\r\n                      :src=\"collect\"\r\n                      alt\r\n                      title=\"取消收藏\"\r\n                      @click=\"Collection(index,value)\"\r\n                      style=\"width: 15px;height: 15px;\"\r\n                    />\r\n                    <p style=\"margin-top: 5px\">\r\n                      <span>相似度：</span>\r\n                      {{value.score}}\r\n                    </p>\r\n                    <div style=\"margin-top: 5px;color: red\">\r\n                      <span>均价：</span>\r\n                      {{value.price}}元\r\n                    </div>\r\n                    <a @click=\"getInfo(index,value)\" style=\"font-size: 10px\">查看小区周边详情>></a>\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"sidermenu\">\r\n          <Input v-model=\"distance\" placeholder=\"请输入空间约束：\" clearable style=\"width: 200px\" />\r\n          <Button shape=\"circle\" title=\"自定义选点\" @click=\"createPoint\">\r\n            <span>\r\n              <Icon type=\"ios-pin-outline\" size=\"17\" />\r\n            </span>\r\n          </Button>\r\n          <div>\r\n            <Button type=\"primary\" @click=\"getHouse\">确定</Button>\r\n          </div>\r\n        </div>\r\n        <router-view />\r\n      </Content>\r\n    </Layout>\r\n  </div>\r\n</template>\r\n<script>\r\nimport toolForm from \"@/views/infoSearch/inforCount/public.vue\";\r\nimport buffer from \"@/views/infoSearch/inforCount/buffer.vue\";\r\nimport siteSelection from \"./home/components/siteSelection\";\r\nimport { computeh } from \"@/core/computeh\";\r\nimport GDrawbuffer from \"@/map/api/4+/GDrawBuffer\";\r\nimport GConvertGeometry from \"@/map/api/js/convert/GConvertGeometry\";\r\nimport GDrawSketch from \"@/map/api/4+/GDrawSketch\";\r\nimport Server from \"@/core/server\";\r\nimport { services } from \"@/core/config/services\";\r\nimport houseInfoId from \"@/vuex/store\";\r\nimport dataRap from \"@/vuex/store\";\r\nimport aroundInfo from \"@/vuex/store\";\r\nimport housePoint from \"@/vuex/store\";\r\nexport default {\r\n  mixins: [computeh],\r\n  mounted() {\r\n    var roleid = JSON.parse(sessionStorage.getItem(\"roleId\"));\r\n    if (roleid === \"R0001\" || roleid === \"R0002\") {\r\n      this.show = true;\r\n    } else {\r\n      this.show = false;\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      collect: require(`../../assets/img/collect.png`),\r\n      uncollect: require(`../../assets/img/uncollect.png`),\r\n      house: \"\",\r\n      isExtent: true,\r\n      show: true,\r\n      distance: \"\",\r\n      distance2: \"\",\r\n      isCollapsed: false,\r\n      path: \"10\",\r\n      site: false,\r\n      publicsheshi: \"\",\r\n      isPopup: true,\r\n      isPan: true,\r\n      houseTitle: \"\",\r\n      dialog3: false,\r\n      list: \"\",\r\n      pointY: \"\",\r\n      pointX: \"\"\r\n    };\r\n  },\r\n  computed: {},\r\n\r\n  methods: {\r\n    Collection(index, value) {\r\n      if (value.collected === 0) {\r\n        var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\r\n        this.houseName = value.name;\r\n        this.houseId = value.houseId;\r\n        Server.get({\r\n          url: services.addCollectHouse,\r\n          params: {\r\n            userId: userId,\r\n            houseName: this.houseName\r\n          }\r\n        }).then(rsp => {\r\n          this.$Message.success(rsp.message);\r\n          value.collected = 1;\r\n        });\r\n      } else if (value.collected === 1) {\r\n        this.houseName = value.name;\r\n        var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\r\n        this.$Modal.confirm({\r\n          title: \"提示\",\r\n          content: \"是否取消收藏?\",\r\n          onOk: () => {\r\n            Server.get({\r\n              url: services.delCollectHouse,\r\n              params: {\r\n                userId: userId,\r\n                houseName: this.houseName\r\n              }\r\n            }).then(rsp => {\r\n              if (rsp.status == 1) {\r\n                this.$Message.success(rsp.message);\r\n                value.collected = 0;\r\n              } else {\r\n                this.$Message.error(rsp.message);\r\n              }\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    location(index, value) {\r\n      for (var i = 0, g; (g = window.mapview.graphics.items[i]); i++) {\r\n        var pIndex = \"p\" + index;\r\n        if (g.attributes.id === value.pIndex) {\r\n          var geometry = null;\r\n          if (g.geometry.type === \"point\") {\r\n            geometry = g.geometry;\r\n          } else {\r\n            var extent = g.geometry.extent.clone();\r\n            geometry = extent.expand(2);\r\n          }\r\n          window.mapview.goTo(geometry);\r\n          var attributes = g.attributes;\r\n          mapApi.popup.show({\r\n            mapView: window.mapview,\r\n            res: attributes.attr,\r\n            centerPt: attributes.centerPt\r\n          });\r\n          break;\r\n        }\r\n      }\r\n    },\r\n    getInfo(index, value) {\r\n      debugger;\r\n      this.houseName = value.name;\r\n      this.houseId = value.houseId;\r\n      this.houseShape = value.Shape;\r\n      housePoint.commit(\"housePoint\", this.houseShape);\r\n      Server.get({\r\n        url: services.compareHouseDetails,\r\n        params: {\r\n          houseId: this.houseId\r\n        }\r\n      })\r\n        .then(rsp => {\r\n          if (rsp.status === 1) {\r\n            houseInfoId.commit(\"houseInfoId\", rsp);\r\n          }\r\n        })\r\n        .then(\r\n          Server.get({\r\n            url: services.road,\r\n            params: {\r\n              name: value.name,\r\n              tableName: \"BUSSTATION\",\r\n              distance: this.distance\r\n            }\r\n          }).then(rsp => {\r\n            debugger;\r\n            var _this = this;\r\n            if (rsp.status === 1) {\r\n              aroundInfo.commit(\"aroundInfo\", rsp);\r\n              aroundInfo.commit(\"housueName\", this.houseName);\r\n              this.$router.push(\"/houseinfo\");\r\n            }\r\n          })\r\n        );\r\n    },\r\n    getHouse() {\r\n      debugger;\r\n      this.distance2 = this.distance * 1000;\r\n      var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\r\n      Server.post({\r\n        url: services.getHouseSimilarity,\r\n        params: {\r\n          housePolygon: this.house,\r\n          distance: this.distance2,\r\n          userId: userId,\r\n          pointX: this.pointX,\r\n          pointY: this.pointY\r\n        }\r\n      }).then(rsp => {\r\n        if (rsp.status === 1) {\r\n          this.list = rsp.data.slice(0, 6);\r\n          this.showGraphics();\r\n          this.$Message.success(\"查询成功\");\r\n        } else {\r\n          this.$Message.error(rsp.message);\r\n        }\r\n      });\r\n    },\r\n    createPoint() {\r\n      new GDrawbuffer(window.mapview).then(gDraw => {\r\n        this.gDraw = gDraw;\r\n        this.gDraw.enableCreatePoint(this.distance, buffer => {\r\n          this.house = window.mapApi.convert.toWKTByGeometry.ToWKT(buffer);\r\n          this.pointX = buffer.centroid.x;\r\n          this.pointY = buffer.centroid.y;\r\n          console.log(buffer.centroid.latitude);\r\n          console.log(buffer.centroid.longitude);\r\n          console.log(buffer.centroid.x);\r\n          console.log(buffer.centroid.y);\r\n        });\r\n      });\r\n    },\r\n    showGraphics() {\r\n      if (this.list === 0) return;\r\n      onemap.pubsub.publish(\"drawHouseByList\", {\r\n        list: this.list,\r\n        popup: this.isPopup,\r\n        pan: this.isPan\r\n      });\r\n    }\r\n  },\r\n  components: {\r\n    toolForm,\r\n    buffer,\r\n    siteSelection\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.info {\r\n  position: absolute;\r\n  border: 1px solid #dcdee2;\r\n  background-color: #fff;\r\n  border-color: #e8eaec;\r\n  height: 670px;\r\n  overflow-y: scroll;\r\n  width: 380px;\r\n  padding: 5px;\r\n  right: 0;\r\n  top: 40px;\r\n  z-index: 99;\r\n}\r\n.itemImage {\r\n  height: 80px;\r\n  width: 130px;\r\n}\r\n.sidermenu {\r\n  justify-content: space-between;\r\n  background-color: #fcf9f2;\r\n  border-radius: 5px;\r\n  align-items: center;\r\n  display: flex;\r\n  width: 350px;\r\n  position: absolute;\r\n  border: 1px solid #dcdee2;\r\n  border-color: #e8eaec;\r\n  padding: 5px;\r\n  left: 40px;\r\n  top: 48px;\r\n  transition: all 0.2s ease-in-out;\r\n  z-index: 9999;\r\n}\r\n.kjcx {\r\n  display: block;\r\n}\r\n.ivu-layout-sider {\r\n  height: 300px;\r\n  transition: all 0.2s ease-in-out;\r\n  position: relative;\r\n  background: #fff;\r\n  min-width: 0;\r\n}\r\n.ivu-form-item {\r\n  margin-bottom: 12px;\r\n  vertical-align: top;\r\n  zoom: 1;\r\n}\r\n.menu-item-title {\r\n  height: 48px;\r\n  line-height: 48px;\r\n  font-size: 14px;\r\n  padding-left: 28px;\r\n}\r\n.layout {\r\n  height: 670px;\r\n  background: #f5f7f9;\r\n  position: relative;\r\n  border-radius: 4px;\r\n  overflow: hidden;\r\n}\r\n\r\n.layout-header-bar {\r\n  background: #fcf9f2;\r\n  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);\r\n}\r\n.layout-logo-left {\r\n  width: 90%;\r\n  height: 30px;\r\n  border-radius: 3px;\r\n  margin: 15px auto;\r\n}\r\n.menu-icon {\r\n  transition: all 0.3s;\r\n}\r\n.rotate-icon {\r\n  transform: rotate(-90deg);\r\n}\r\n.menu-item span {\r\n  display: inline-block;\r\n  overflow: hidden;\r\n  width: 69px;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  vertical-align: bottom;\r\n  transition: width 0.2s ease 0.2s;\r\n}\r\n.menu-item i {\r\n  transform: translateX(0px);\r\n  transition: font-size 0.2s ease, transform 0.2s ease;\r\n  vertical-align: middle;\r\n  font-size: 16px;\r\n}\r\n.collapsed-menu span {\r\n  width: 0px;\r\n  transition: width 0.2s ease;\r\n}\r\n.collapsed-menu i {\r\n  transform: translateX(5px);\r\n  transition: font-size 0.2s ease 0.2s, transform 0.2s ease 0.2s;\r\n  vertical-align: middle;\r\n  font-size: 22px;\r\n}\r\n.siderItem {\r\n  margin-left: 1px;\r\n}\r\n</style>\r\n"]}]}