{"remainingRequest":"D:\\graduate\\node_modules\\babel-loader\\lib\\index.js!D:\\graduate\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\graduate\\src\\views\\spaceRecommendation\\spaceRecommendation.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\graduate\\src\\views\\spaceRecommendation\\spaceRecommendation.vue","mtime":1584791162788},{"path":"D:\\graduate\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1580901136398},{"path":"D:\\graduate\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\graduate\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport _slicedToArray from \"D:\\\\graduate\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/slicedToArray\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport MapToolsView from \"@/map/components/MapToolsView\";\nimport Server from \"@/core/server\";\nimport { services } from \"@/core/config/services\";\nimport GDrawSketch from \"@/map/api/4+/GDrawSketch\";\nimport GDrawbuffer from \"@/map/api/4+/GDrawBuffer\";\nimport GConvertGeometry from \"@/map/api/js/convert/GConvertGeometry\";\nexport default {\n  components: {\n    measureArea: measureArea,\n    measureLength: measureLength,\n    MapToolsView: MapToolsView,\n    Item: Item,\n    MapLayerView: MapLayerView\n  },\n  created: function created() {\n    var _this = this;\n\n    this.$root.Bus.$on(\"eventSelectBuffer\", function () {\n      _this.dialog2 = true;\n    });\n  },\n  data: function data() {\n    return {\n      IsMapToolsView: false,\n      dialog2: false,\n      house: \"\",\n      isExtent: true,\n      isPopup: true,\n      isPan: true,\n      list: \"\",\n      distance: \"\"\n    };\n  },\n  methods: {\n    getHouse: function getHouse() {\n      var _this2 = this;\n\n      debugger;\n      Server.post({\n        url: services.getHouse,\n        params: {\n          housePolygon: this.house\n        }\n      }).then(function (rsp) {\n        if (rsp.status === 1) {\n          _this2.list = rsp.data;\n\n          _this2.showGraphics();\n\n          _this2.$Message.success(\"查询成功\"); // sessionStorage.setItem(\"userInfo\", JSON.stringify(this.user))\n\n        } else {\n          _this2.$Message.error(rsp.message);\n        }\n      });\n    },\n    createPoint: function createPoint() {\n      var _this3 = this;\n\n      new GDrawbuffer(window.mapview).then(function (gDraw) {\n        _this3.gDraw = gDraw;\n\n        _this3.gDraw.enableCreatePoint(_this3.distance, function (buffer) {\n          _this3.house = window.mapApi.convert.toWKTByGeometry.ToWKT(buffer);\n          console.log(buffer.centroid.latitude);\n          console.log(buffer.centroid.longitude);\n          console.log(buffer.centroid.x);\n          console.log(buffer.centroid.y);\n        }); // console.log(shape1);\n        // var buffer = this.gDraw.enableCreatePoint(this.distance);\n        // console.log(buffer);\n        // console.log(this.gDraw);\n        // this.gDraw.on(\"draw-complete\", e => {\n        //   // let shape = mapApi.convert.toWKTByGeometry.ToWKT(e.geometry);\n        //   // this.shape = shape;\n        //   // console.log(this.shape);\n        //   // parent.onemap.pubsub.publish(\"drawPolygon\", shape);\n        // });\n\n      });\n    },\n    showGraphics: function showGraphics() {\n      //render graphic\n      if (this.list === 0) return;\n      onemap.pubsub.publish(\"drawHouseByList\", {\n        list: this.list,\n        popup: this.isPopup,\n        pan: this.isPan\n      });\n    },\n    addLayer: function addLayer(callback) {\n      var _this4 = this;\n\n      esriLoader.loadScript({\n        url: MapAPI.js,\n        css: MapAPI.css\n      }).then(function (r) {\n        esriLoader.loadModules([\"esri/config\", \"esri/Map\", \"esri/layers/GroupLayer\", \"esri/Basemap\", \"esri/views/MapView\", \"esri/layers/MapImageLayer\", \"esri/layers/TileLayer\", \"esri/geometry/Extent\", \"esri/widgets/LayerList\"]).then(function (_ref) {\n          var _ref2 = _slicedToArray(_ref, 11),\n              esriConfig = _ref2[0],\n              Map = _ref2[1],\n              GroupLayer = _ref2[2],\n              Basemap = _ref2[3],\n              MapView = _ref2[4],\n              MapImageLayer = _ref2[5],\n              TileLayer = _ref2[6],\n              Extent = _ref2[7],\n              LayerList = _ref2[8],\n              dom = _ref2[9],\n              on = _ref2[10];\n\n          // esriConfig.request.corsEnabledServers.push(\"122.112.216.247/\");\n          var activeWidget = null;\n          var layer = new TileLayer({\n            url: \"http://localhost:6080/arcgis/rest/services/chouz/Map/MapServer\"\n          });\n          _this4.baseLayer = layer; // var street = new TileLayer({\n          //   url:\n          //     \"https://localhost:6443/arcgis/rest/services/ChuZhou/ChuZhouYX/MapServer\",\n          //   visible: false\n          // });\n          // this.street = street;\n          // var USALayer = new MapImageLayer({\n          //   url:\n          //     \"http://122.112.216.247:6080/arcgis/rest/services/CHUZHOU/odqllj/MapServer\",\n          //   title: \"od成本\",\n          //   visible: false\n          // });\n          // var censusLayer = new MapImageLayer({\n          //   url:\n          //     \"http://122.112.216.247:6080/arcgis/rest/services/CHUZHOU/zhonguexuequ/MapServer\",\n          //   title: \"学区数据\",\n          //   opacity: 0.8,\n          //   visible: false\n          // });\n\n          var baseMap = new Basemap({\n            baseLayers: [layer]\n          }); // var demographicGroupLayer = new GroupLayer({\n          //   title: \"专题图层\",\n          //   visible: true,\n          //   visibilityMode: \"independent\",\n          //   layers: [USALayer, censusLayer]\n          //   //\n          // });\n\n          var map = new Map({\n            basemap: baseMap // layers: [demographicGroupLayer]\n\n          });\n          var ext = String(_this4.defaultMapExtent).split(\",\");\n\n          if (ext.length > 3) {\n            console.log(\"extent 配置有误\");\n            return false;\n          }\n\n          var zoom = parseInt(ext[2]);\n          var center = {\n            x: parseFloat(ext[0]),\n            y: parseFloat(ext[1]),\n            spatialReference: _this4.spatialReference\n          };\n          _this4.mapview = new MapView({\n            container: \"viewDiv\",\n            map: map,\n            zoom: zoom,\n            center: center\n          });\n\n          _this4.mapview.ui.remove([\"attribution\", \"zoom\"]);\n\n          var view = _this4.mapview; // view.when(function() {\n          //   var layerList = new LayerList({\n          //     view: view\n          //   });\n          //   view.ui.add(layerList, \"top-right\");\n          // });\n\n          _this4.mapview.initExtent = {\n            center: center,\n            zoom: zoom\n          };\n          window.mapview = _this4.mapview;\n          callback(_this4.mapview);\n          _this4.IsMapToolsView = true;\n        });\n      });\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.$root.Bus.$off(\"eventSelectBuffer\");\n  }\n};",{"version":3,"sources":["spaceRecommendation.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div id=\"viewDiv\" region=\"center\">\n    <div class=\"tools\">\n      <MapToolsView :mapView=\"mapview\" v-if=\"IsMapToolsView\" :url=\"toolsUrl\"></MapToolsView>\n    </div>\n    <Modal v-model=\"dialog2\" :mask-closable=\"false\" width=\"400\" title=\"缓冲区查询\" draggable>\n      <Form :label-width=\"60\">\n        <FormItem label=\"半径：\" prop=\"zoning\" :width=\"80\">\n          <div style=\"width:260px ;display:inline-block\">\n            <Input v-model=\"distance\" placeholder clearable></Input>\n          </div>\n          <span style=\"width:20px;margin-left:15px\">千米</span>\n        </FormItem>\n        <FormItem label=\"选点：\" prop=\"zoning\">\n          <Button shape=\"circle\" title=\"自定义选点\" @click=\"createPoint\">\n            <span>\n              <Icon type=\"ios-pin-outline\" size=\"17\" />\n            </span>\n          </Button>\n        </FormItem>\n      </Form>\n      <div slot=\"footer\">\n        <Button type=\"primary\" size=\"large\" long @click=\"getHouse\">查询</Button>\n      </div>\n    </Modal>\n  </div>\n</template>\n <script>\nimport MapToolsView from \"@/map/components/MapToolsView\";\nimport Server from \"@/core/server\";\nimport { services } from \"@/core/config/services\";\nimport GDrawSketch from \"@/map/api/4+/GDrawSketch\";\nimport GDrawbuffer from \"@/map/api/4+/GDrawBuffer\";\nimport GConvertGeometry from \"@/map/api/js/convert/GConvertGeometry\";\nexport default {\n  components: {\n    measureArea,\n    measureLength,\n    MapToolsView,\n    Item,\n    MapLayerView\n  },\n  created() {\n    this.$root.Bus.$on(\"eventSelectBuffer\", () => {\n      this.dialog2 = true;\n    });\n  },\n  data() {\n    return {\n      IsMapToolsView: false,\n      dialog2: false,\n      house: \"\",\n      isExtent: true,\n      isPopup: true,\n      isPan: true,\n      list: \"\",\n      distance: \"\"\n    };\n  },\n  methods: {\n    getHouse() {\n      debugger;\n      Server.post({\n        url: services.getHouse,\n        params: {\n          housePolygon: this.house\n        }\n      }).then(rsp => {\n        if (rsp.status === 1) {\n          this.list = rsp.data;\n          this.showGraphics();\n          this.$Message.success(\"查询成功\");\n          // sessionStorage.setItem(\"userInfo\", JSON.stringify(this.user))\n        } else {\n          this.$Message.error(rsp.message);\n        }\n      });\n    },\n    createPoint() {\n      new GDrawbuffer(window.mapview).then(gDraw => {\n        this.gDraw = gDraw;\n        this.gDraw.enableCreatePoint(this.distance, buffer => {\n          this.house = window.mapApi.convert.toWKTByGeometry.ToWKT(buffer);\n          console.log(buffer.centroid.latitude);\n          console.log(buffer.centroid.longitude);\n          console.log(buffer.centroid.x);\n          console.log(buffer.centroid.y);\n        });\n        // console.log(shape1);\n        // var buffer = this.gDraw.enableCreatePoint(this.distance);\n        // console.log(buffer);\n        // console.log(this.gDraw);\n        // this.gDraw.on(\"draw-complete\", e => {\n        //   // let shape = mapApi.convert.toWKTByGeometry.ToWKT(e.geometry);\n        //   // this.shape = shape;\n        //   // console.log(this.shape);\n        //   // parent.onemap.pubsub.publish(\"drawPolygon\", shape);\n        // });\n      });\n    },\n    showGraphics() {\n      //render graphic\n\n      if (this.list === 0) return;\n      onemap.pubsub.publish(\"drawHouseByList\", {\n        list: this.list,\n        popup: this.isPopup,\n        pan: this.isPan\n      });\n    },\n    addLayer(callback) {\n      esriLoader\n        .loadScript({\n          url: MapAPI.js,\n          css: MapAPI.css\n        })\n        .then(r => {\n          esriLoader\n            .loadModules([\n              \"esri/config\",\n              \"esri/Map\",\n              \"esri/layers/GroupLayer\",\n              \"esri/Basemap\",\n              \"esri/views/MapView\",\n              \"esri/layers/MapImageLayer\",\n              \"esri/layers/TileLayer\",\n              \"esri/geometry/Extent\",\n              \"esri/widgets/LayerList\"\n            ])\n            .then(\n              ([\n                esriConfig,\n                Map,\n                GroupLayer,\n                Basemap,\n                MapView,\n                MapImageLayer,\n                TileLayer,\n                Extent,\n                LayerList,\n                dom,\n                on\n              ]) => {\n                // esriConfig.request.corsEnabledServers.push(\"122.112.216.247/\");\n\n                var activeWidget = null;\n\n                var layer = new TileLayer({\n                  url:\n                    \"http://localhost:6080/arcgis/rest/services/chouz/Map/MapServer\"\n                });\n                this.baseLayer = layer;\n\n                // var street = new TileLayer({\n                //   url:\n                //     \"https://localhost:6443/arcgis/rest/services/ChuZhou/ChuZhouYX/MapServer\",\n                //   visible: false\n                // });\n\n                // this.street = street;\n                // var USALayer = new MapImageLayer({\n                //   url:\n                //     \"http://122.112.216.247:6080/arcgis/rest/services/CHUZHOU/odqllj/MapServer\",\n                //   title: \"od成本\",\n                //   visible: false\n                // });\n\n                // var censusLayer = new MapImageLayer({\n                //   url:\n                //     \"http://122.112.216.247:6080/arcgis/rest/services/CHUZHOU/zhonguexuequ/MapServer\",\n                //   title: \"学区数据\",\n                //   opacity: 0.8,\n                //   visible: false\n                // });\n                var baseMap = new Basemap({\n                  baseLayers: [layer]\n                });\n                // var demographicGroupLayer = new GroupLayer({\n                //   title: \"专题图层\",\n                //   visible: true,\n                //   visibilityMode: \"independent\",\n                //   layers: [USALayer, censusLayer]\n                //   //\n                // });\n\n                var map = new Map({\n                  basemap: baseMap\n                  // layers: [demographicGroupLayer]\n                });\n                var ext = String(this.defaultMapExtent).split(\",\");\n\n                if (ext.length > 3) {\n                  console.log(\"extent 配置有误\");\n                  return false;\n                }\n                var zoom = parseInt(ext[2]);\n                var center = {\n                  x: parseFloat(ext[0]),\n                  y: parseFloat(ext[1]),\n                  spatialReference: this.spatialReference\n                };\n                this.mapview = new MapView({\n                  container: \"viewDiv\",\n                  map: map,\n                  zoom: zoom,\n                  center: center\n                });\n                this.mapview.ui.remove([\"attribution\", \"zoom\"]);\n                var view = this.mapview;\n                // view.when(function() {\n                //   var layerList = new LayerList({\n                //     view: view\n                //   });\n                //   view.ui.add(layerList, \"top-right\");\n                // });\n\n                this.mapview.initExtent = {\n                  center: center,\n                  zoom: zoom\n                };\n                window.mapview = this.mapview;\n                callback(this.mapview);\n                this.IsMapToolsView = true;\n              }\n            );\n        });\n    }\n  },\n  beforeDestroy() {\n    this.$root.Bus.$off(\"eventSelectBuffer\");\n  }\n};\n</script>\n<style >\n/* .ivu-input {\n    display: inline-block;\n    width: 80%;\n    height: 32px;\n    line-height: 1.5;\n    padding: 4px 7px;\n    font-size: 12px;\n    border: 1px solid #dcdee2;\n    border-radius: 4px;\n    color: #515a6e;\n    background-color: #fff;\n    background-image: none;\n    position: relative;\n    cursor: text;\n    transition: border .2s ease-in-out,background .2s ease-in-out,box-shadow .2s ease-in-out;\n} */\n</style>\n\n "],"sourceRoot":"src\\views\\spaceRecommendation"}]}