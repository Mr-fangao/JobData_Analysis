{"remainingRequest":"E:\\04 GIS相关比赛\\05 “创青春”比赛(省赛阶段)\\07 系统代码\\jobData_Analysis前端\\node_modules\\babel-loader\\lib\\index.js!E:\\04 GIS相关比赛\\05 “创青春”比赛(省赛阶段)\\07 系统代码\\jobData_Analysis前端\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\04 GIS相关比赛\\05 “创青春”比赛(省赛阶段)\\07 系统代码\\jobData_Analysis前端\\src\\views\\recommendation\\components\\housingPreference.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\04 GIS相关比赛\\05 “创青春”比赛(省赛阶段)\\07 系统代码\\jobData_Analysis前端\\src\\views\\recommendation\\components\\housingPreference.vue","mtime":1599565573585},{"path":"E:\\04 GIS相关比赛\\05 “创青春”比赛(省赛阶段)\\07 系统代码\\jobData_Analysis前端\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1580901136398},{"path":"E:\\04 GIS相关比赛\\05 “创青春”比赛(省赛阶段)\\07 系统代码\\jobData_Analysis前端\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\04 GIS相关比赛\\05 “创青春”比赛(省赛阶段)\\07 系统代码\\jobData_Analysis前端\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Server from \"@/core/server\";\nimport { services } from \"@/core/config/services\";\nimport houseInfoId from \"@/vuex/store\";\nimport dataRap from \"@/vuex/store\";\nimport aroundInfo from \"@/vuex/store\";\nimport housePoint from \"@/vuex/store\";\nexport default {\n  computed: {},\n  name: \"mapbox\",\n  data: function data() {\n    return {\n      center: {\n        lng: 0,\n        lat: 0\n      },\n      zoom: 3,\n      distance: \"1000\",\n      value6: \"南台新苑安\",\n      information2: [],\n      information1: [],\n      houseName: \"\",\n      collect: require(\".././../../assets/img/collect.png\"),\n      uncollect: require(\".././../../assets/img/uncollect.png\"),\n      userInfo: [],\n      userage: [],\n      money: [],\n      educations: [],\n      user: \"\",\n      BaseOnHouses: [],\n      userLocationLon: \"\",\n      userLocationLat: \"\"\n    };\n  },\n  watch: {\n    asyncArray: function asyncArray() {\n      this.$nextTick(function () {\n        this.saveUserLocation();\n      });\n    }\n  },\n  mounted: function mounted() {\n    // this.getInfos();\n    this.getSmiarly(); // this.getdata();\n  },\n  methods: {\n    saveUserLocation: function saveUserLocation() {\n      var this_ = this;\n      var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\n      Server.post({\n        url: services.saveUserLocation,\n        params: {\n          userId: userId,\n          lon: this.userLocationLon,\n          lat: this.userLocationLat\n        }\n      }).then(function (rsp) {\n        console.log(rsp);\n\n        if (rsp.code === 20000) {\n          this.getSmiarly();\n        }\n      });\n    },\n    handler: function handler(_ref) {\n      var BMap = _ref.BMap,\n          map = _ref.map;\n      var Item = this.selectIetm;\n      var list = \"\"; // console.log(Item);\n\n      map.enableScrollWheelZoom(true); //开启鼠标滚轮缩放\n\n      this.center.lng = 116.331398;\n      this.center.lat = 39.897445;\n      this.zoom = 12;\n      map.setMinZoom(6);\n      map.setMaxZoom(16);\n      var geolocation = new BMap.Geolocation(); //定位到用户城市\n\n      geolocation.getCurrentPosition(function (r) {\n        if (this.getStatus() == BMAP_STATUS_SUCCESS) {\n          var mk = new BMap.Marker(r.point);\n          map.panTo(r.point);\n        } else {\n          alert(\"failed\" + this.getStatus());\n        }\n      }, {\n        enableHighAccuracy: true\n      });\n      map.addEventListener(\"click\", function (e) {\n        this.userLocationLon = e.point.lng;\n        this.userLocationLat = e.point.lat;\n        saveUserLocation(this.userLocationLon, this.userLocationLat);\n        console.log(this.userLocationLon);\n        console.log(this.userLocationLat);\n      });\n\n      function saveUserLocation(p1, p2) {\n        var this_ = this;\n        var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\n        Server.post({\n          url: services.saveUserLocation,\n          params: {\n            userId: userId,\n            lon: p1,\n            lat: p2\n          }\n        }).then(function (rsp) {\n          console.log(rsp);\n\n          if (rsp.code === 20000) {\n            this.getSmiarly();\n          }\n        });\n      }\n    },\n    getSmiarly: function getSmiarly() {\n      var this_ = this;\n      var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\n      console.log(userId);\n      Server.get({\n        url: services.recommendedBaseSpatial,\n        params: {\n          userId: userId\n        }\n      }).then(function (rsp) {\n        if (rsp.code === 20000) {\n          // console.log(rsp);\n          this_.BaseOnHouses = rsp.data.data;\n          console.log(this_.BaseOnHouses); //   this_.information1=this_.BaseOnHouses.slice(0,3)\n          //   this_.information2 = this_.BaseOnHouses.slice(4);\n          //   console.log(this.information2 )\n          // console.log(this.BaseOnHouses);\n        }\n      });\n    },\n    getInfos: function getInfos() {\n      var _this2 = this;\n\n      var this_ = this;\n      var user = JSON.parse(sessionStorage.getItem(\"userAccount\"));\n      this.user = user;\n      var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\n      Server.get({\n        url: services.getInfo,\n        params: {\n          username: user,\n          userId: userId\n        }\n      }).then(function (rsp) {\n        _this2.userInfo = rsp.data;\n        debugger; // this.userage = rsp.data.userEducationLevel;\n\n        for (var i = 1; i < 9; i++) {\n          if (_this2.userInfo.age == i) {\n            _this2.userage = _this2.age[i - 1].label;\n          }\n        }\n\n        for (var _i = 1; _i <= 9; _i++) {\n          if (_this2.userInfo.userMoney == _i) {\n            _this2.money = _this2.capital[_i - 1].label;\n          }\n        }\n\n        for (var _i2 = 0; _i2 < 9; _i2++) {\n          if (_this2.userInfo.userEducationLevel == _i2) {\n            _this2.educations = _this2.education[_i2 - 1].label;\n          }\n        }\n      });\n    },\n    getInfo: function getInfo(index, value) {\n      var _this3 = this;\n\n      this.houseName = value.neighborhood;\n      this.houseId = value.id;\n      this.houseShape = value.Shape;\n      housePoint.commit(\"housePoint\", this.houseShape);\n      Server.get({\n        url: services.compareHouseDetails,\n        params: {\n          houseId: this.houseId\n        }\n      }).then(function (rsp) {\n        var _this = _this3;\n\n        if (rsp.code === 20000) {\n          houseInfoId.commit(\"houseInfoId\", rsp);\n          aroundInfo.commit(\"aroundInfo\", rsp);\n          aroundInfo.commit(\"housueName\", _this3.houseName);\n\n          _this3.$router.push(\"/houseinfo\");\n        }\n      });\n    },\n    getdata: function getdata() {\n      var this_ = this;\n      var information = this_.BaseOnHouses;\n      console.log(this_.BaseOnHouses);\n      console.log(information);\n      this.information2 = information.slice(3, information.length);\n      this.information1.push(information[0], information[1], information[2]);\n    },\n    Collection: function Collection(index, value) {\n      var _this4 = this;\n\n      var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\n\n      if (value.collected === 0) {\n        this.houseName = value.name;\n        this.houseId = value.houseId;\n        Server.get({\n          url: services.addCollectHouse,\n          params: {\n            userId: userId,\n            houseName: this.houseName\n          }\n        }).then(function (rsp) {\n          _this4.$Message.success(rsp.message);\n\n          value.collected = 1;\n        });\n      } else if (value.collected === 1) {\n        this.houseName = value.name;\n        this.$Modal.confirm({\n          title: \"提示\",\n          content: \"是否取消收藏?\",\n          onOk: function onOk() {\n            Server.get({\n              url: services.delCollectHouse,\n              params: {\n                userId: userId,\n                houseName: _this4.houseName\n              }\n            }).then(function (rsp) {\n              if (rsp.status == 1) {\n                _this4.$Message.success(rsp.message);\n\n                value.collected = 0;\n              } else {\n                _this4.$Message.error(rsp.message);\n              }\n            });\n          }\n        });\n      }\n    }\n  }\n};",{"version":3,"sources":["housingPreference.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <Layout>\r\n    <Content>\r\n      <div style=\"margin: 0 auto;width: 95%;\">\r\n        <!--<TabPane label=\"基于用户位置推荐\">-->\r\n        <Card>\r\n          <Row :gutter=\"30\">\r\n            <Col span=\"12\">\r\n              <div\r\n                class=\"mapbox\"\r\n                style=\"width:1250px;height:300px;overflow-x:hidden;overflow-y:hidden;\"\r\n              >\r\n                <baidu-map\r\n                  :center=\"center\"\r\n                  :zoom=\"zoom\"\r\n                  :scroll-wheel-zoom=\"true\"\r\n                  style=\"height:100vh\"\r\n                  @ready=\"handler\"\r\n                >\r\n                  <bm-geolocation\r\n                    anchor=\"BMAP_ANCHOR_BOTTOM_RIGHT\"\r\n                    :showAddressBar=\"true\"\r\n                    :autoLocation=\"true\"\r\n                  ></bm-geolocation>\r\n                </baidu-map>\r\n              </div>\r\n            </Col>\r\n          </Row>\r\n          \r\n        </Card>\r\n        <!-- <Card>\r\n          <Row :gutter=\"30\">\r\n            <div v-for=\"(value,index) in information1\" :key=\"index\">\r\n              <Col span=\"8\">\r\n                <Card style=\"padding: 0;\">\r\n                  <div style=\"text-align:center\">\r\n                    <img\r\n                      @click=\"getInfo(index,value)\"\r\n                      style=\"width: 320px;height: 230px\"\r\n                      v-bind:src=\"value.image\"\r\n                      alt\r\n                    />\r\n                    <div style=\"overflow: hidden\">\r\n                      <h2 style=\"float: left;font-size: 15px\">{{value.neighborhood}}</h2>\r\n                      <img\r\n                        v-if=\"value.collected == '0'\"\r\n                        :src=\"uncollect\"\r\n                        alt\r\n                        title=\"收藏\"\r\n                        @click=\"Collection(index,value)\"\r\n                        style=\"width: 15px;height: 15px;margin-top: 7px;margin-left: 15px;float: left\"\r\n                      />\r\n                      <img\r\n                        v-else-if=\"value.collected == '1'\"\r\n                        :src=\"collect\"\r\n                        alt\r\n                        title=\"取消收藏\"\r\n                        @click=\"Collection(index,value)\"\r\n                        style=\"width: 15px;height: 15px;margin-top: 7px;margin-left: 15px;float: left\"\r\n                      />\r\n                      <span style=\"float: right\">{{value.price}}元/㎡</span>\r\n                    </div>\r\n                  </div>\r\n                </Card>\r\n              </Col>\r\n            </div>\r\n          </Row>\r\n        </Card>-->\r\n        <card>\r\n          <div>\r\n            <div v-for=\"(value,index) in BaseOnHouses\" :key=\"index\">\r\n              <div @click=\"location(index,value)\" style=\"border-bottom:1px solid #999\">\r\n                <Row>\r\n                  <Col span=\"7\">\r\n                    <div class=\"left mend_img\">\r\n                      <img\r\n                        style=\"width: 250px;height: 150px;margin-top: 20px;margin-bottom: 10px\"\r\n                        v-bind:src=\"value.image\"\r\n                      />\r\n                    </div>\r\n                  </Col>\r\n                  <Col span=\"17\">\r\n                    <div class=\"left name\" style=\"margin-top: 35px\">\r\n                      <div style=\"margin-top: 25px;float: right;margin-right: 10%\">\r\n                        <span style=\"color: red;font-weight: bold;\">：{{value.price}}元/月</span>\r\n                        <p style=\"margin-top: 5px;font-size: 13px\">\r\n                          <span>楼层高度：{{value.floors}}</span>\r\n                        </p>\r\n                        <p style=\"margin-top: 5px;font-size: 13px\">\r\n                          <span>出租方式：{{value.rentWay}}</span>\r\n                        </p>\r\n                        <p style=\"margin-top: 5px;font-size: 13px\">\r\n                          <span>房屋面积：{{value.area}}㎡</span>\r\n                        </p>\r\n                      </div>\r\n                      <h2 style=\"display:inline-block;font-size: 15px\">{{value.name}}</h2>\r\n                      <img\r\n                        v-if=\"value.collected == '0'\"\r\n                        :src=\"uncollect\"\r\n                        alt\r\n                        title=\"收藏\"\r\n                        @click=\"Collection(index,value)\"\r\n                        id=\"index\"\r\n                        style=\"width: 15px;height: 15px;margin-left: 20px\"\r\n                      />\r\n                      <img\r\n                        v-else-if=\"value.collected == '1'\"\r\n                        :src=\"collect\"\r\n                        alt\r\n                        title=\"取消收藏\"\r\n                        @click=\"Collection(index,value)\"\r\n                        style=\"width: 15px;height: 15px;margin-left: 20px\"\r\n                      />\r\n\r\n                      <p style=\"margin-top: 5px;font-size: 13px\">\r\n                        <span>小区名称：</span>\r\n                        {{value.neighborhood}}\r\n                      </p>\r\n                      <p style=\"margin-top: 5px;font-size: 13px\">\r\n                        <span>租房简介：</span>\r\n                        {{value.title}}\r\n                      </p>\r\n                      <p style=\"margin-top: 5px;font-size: 13px\">\r\n                        <span>地址：</span>\r\n                        {{value.address}}\r\n                      </p>\r\n                      <p style=\"margin-top: 5px\">\r\n                        <a @click=\"getInfo(index,value)\" style=\"font-size: 10px\">查看小区详情>></a>\r\n                      </p>\r\n                    </div>\r\n                  </Col>\r\n                </Row>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </card>\r\n      </div>\r\n    </Content>\r\n  </Layout>\r\n</template>\r\n<script>\r\nimport Server from \"@/core/server\";\r\nimport { services } from \"@/core/config/services\";\r\nimport houseInfoId from \"@/vuex/store\";\r\nimport dataRap from \"@/vuex/store\";\r\nimport aroundInfo from \"@/vuex/store\";\r\nimport housePoint from \"@/vuex/store\";\r\n\r\nexport default {\r\n  computed: {},\r\n  name: \"mapbox\",\r\n  data() {\r\n    return {\r\n      center: { lng: 0, lat: 0 },\r\n      zoom: 3,\r\n      distance: \"1000\",\r\n      value6: \"南台新苑安\",\r\n      information2: [],\r\n      information1: [],\r\n      houseName: \"\",\r\n      collect: require(`.././../../assets/img/collect.png`),\r\n      uncollect: require(`.././../../assets/img/uncollect.png`),\r\n      userInfo: [],\r\n      userage: [],\r\n      money: [],\r\n      educations: [],\r\n      user: \"\",\r\n      BaseOnHouses: [],\r\n      userLocationLon: \"\",\r\n      userLocationLat: \"\",\r\n    };\r\n  },\r\n  watch: {\r\n    asyncArray: function () {\r\n      this.$nextTick(function () {\r\n        this.saveUserLocation();\r\n      });\r\n    },\r\n  },\r\n  mounted() {\r\n    // this.getInfos();\r\n    this.getSmiarly();\r\n    // this.getdata();\r\n  },\r\n  methods: {\r\n    saveUserLocation() {\r\n      var this_ = this;\r\n      var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\r\n      Server.post({\r\n        url: services.saveUserLocation,\r\n        params: {\r\n          userId: userId,\r\n          lon: this.userLocationLon,\r\n          lat: this.userLocationLat,\r\n        },\r\n      }).then(function (rsp) {\r\n        console.log(rsp);\r\n        if (rsp.code === 20000) {\r\n          this.getSmiarly();\r\n        }\r\n      });\r\n    },\r\n    handler({ BMap, map }) {\r\n      var Item = this.selectIetm;\r\n      var list = \"\";\r\n      // console.log(Item);\r\n      map.enableScrollWheelZoom(true); //开启鼠标滚轮缩放\r\n      this.center.lng = 116.331398;\r\n      this.center.lat = 39.897445;\r\n      this.zoom = 12;\r\n      map.setMinZoom(6);\r\n      map.setMaxZoom(16);\r\n      var geolocation = new BMap.Geolocation();\r\n      //定位到用户城市\r\n      geolocation.getCurrentPosition(\r\n        function (r) {\r\n          if (this.getStatus() == BMAP_STATUS_SUCCESS) {\r\n            var mk = new BMap.Marker(r.point);\r\n            map.panTo(r.point);\r\n          } else {\r\n            alert(\"failed\" + this.getStatus());\r\n          }\r\n        },\r\n        { enableHighAccuracy: true }\r\n      );\r\n      map.addEventListener(\"click\", function (e) {\r\n        this.userLocationLon = e.point.lng;\r\n        this.userLocationLat = e.point.lat;\r\n        saveUserLocation(this.userLocationLon,this.userLocationLat)\r\n        console.log(this.userLocationLon);\r\n        console.log(this.userLocationLat);\r\n      });\r\n      function saveUserLocation(p1,p2) {\r\n        var this_ = this;\r\n        var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\r\n        Server.post({\r\n          url: services.saveUserLocation,\r\n          params: {\r\n            userId: userId,\r\n            lon: p1,\r\n            lat: p2,\r\n          },\r\n        }).then(function (rsp) {\r\n          console.log(rsp);\r\n          if (rsp.code === 20000) {\r\n            this.getSmiarly();\r\n          }\r\n        });\r\n      }\r\n    },\r\n    getSmiarly() {\r\n      var this_ = this;\r\n      var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\r\n      console.log(userId);\r\n      Server.get({\r\n        url: services.recommendedBaseSpatial,\r\n        params: {\r\n          userId: userId,\r\n        },\r\n      }).then(function (rsp) {\r\n        if (rsp.code === 20000) {\r\n          // console.log(rsp);\r\n          this_.BaseOnHouses = rsp.data.data;\r\n          console.log(this_.BaseOnHouses);\r\n          //   this_.information1=this_.BaseOnHouses.slice(0,3)\r\n          //   this_.information2 = this_.BaseOnHouses.slice(4);\r\n          //   console.log(this.information2 )\r\n          // console.log(this.BaseOnHouses);\r\n        }\r\n      });\r\n    },\r\n    getInfos() {\r\n      var this_ = this;\r\n      var user = JSON.parse(sessionStorage.getItem(\"userAccount\"));\r\n      this.user = user;\r\n      var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\r\n      Server.get({\r\n        url: services.getInfo,\r\n        params: {\r\n          username: user,\r\n          userId: userId,\r\n        },\r\n      }).then((rsp) => {\r\n        this.userInfo = rsp.data;\r\n        debugger;\r\n        // this.userage = rsp.data.userEducationLevel;\r\n        for (let i = 1; i < 9; i++) {\r\n          if (this.userInfo.age == i) {\r\n            this.userage = this.age[i - 1].label;\r\n          }\r\n        }\r\n        for (let i = 1; i <= 9; i++) {\r\n          if (this.userInfo.userMoney == i) {\r\n            this.money = this.capital[i - 1].label;\r\n          }\r\n        }\r\n        for (let i = 0; i < 9; i++) {\r\n          if (this.userInfo.userEducationLevel == i) {\r\n            this.educations = this.education[i - 1].label;\r\n          }\r\n        }\r\n      });\r\n    },\r\n    getInfo(index, value) {\r\n      this.houseName = value.neighborhood;\r\n      this.houseId = value.id;\r\n      this.houseShape = value.Shape;\r\n      housePoint.commit(\"housePoint\", this.houseShape);\r\n      Server.get({\r\n        url: services.compareHouseDetails,\r\n        params: {\r\n          houseId: this.houseId,\r\n        },\r\n      }).then((rsp) => {\r\n        var _this = this;\r\n        if (rsp.code === 20000) {\r\n          houseInfoId.commit(\"houseInfoId\", rsp);\r\n          aroundInfo.commit(\"aroundInfo\", rsp);\r\n          aroundInfo.commit(\"housueName\", this.houseName);\r\n          this.$router.push(\"/houseinfo\");\r\n        }\r\n      });\r\n    },\r\n    getdata() {\r\n      var this_ = this;\r\n      var information = this_.BaseOnHouses;\r\n      console.log(this_.BaseOnHouses);\r\n      console.log(information);\r\n      this.information2 = information.slice(3, information.length);\r\n      this.information1.push(information[0], information[1], information[2]);\r\n    },\r\n    Collection(index, value) {\r\n      var userId = JSON.parse(sessionStorage.getItem(\"userId\"));\r\n      if (value.collected === 0) {\r\n        this.houseName = value.name;\r\n        this.houseId = value.houseId;\r\n        Server.get({\r\n          url: services.addCollectHouse,\r\n          params: {\r\n            userId: userId,\r\n            houseName: this.houseName,\r\n          },\r\n        }).then((rsp) => {\r\n          this.$Message.success(rsp.message);\r\n          value.collected = 1;\r\n        });\r\n      } else if (value.collected === 1) {\r\n        this.houseName = value.name;\r\n        this.$Modal.confirm({\r\n          title: \"提示\",\r\n          content: \"是否取消收藏?\",\r\n          onOk: () => {\r\n            Server.get({\r\n              url: services.delCollectHouse,\r\n              params: {\r\n                userId: userId,\r\n                houseName: this.houseName,\r\n              },\r\n            }).then((rsp) => {\r\n              if (rsp.status == 1) {\r\n                this.$Message.success(rsp.message);\r\n                value.collected = 0;\r\n              } else {\r\n                this.$Message.error(rsp.message);\r\n              }\r\n            });\r\n          },\r\n        });\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" >\r\n.ivu-tabs-bar {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.ivu-form-item {\r\n  margin-bottom: 0;\r\n}\r\n</style>\r\n"],"sourceRoot":"src\\views\\recommendation\\components"}]}