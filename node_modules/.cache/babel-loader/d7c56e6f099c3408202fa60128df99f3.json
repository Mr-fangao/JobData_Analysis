{"remainingRequest":"E:\\00 毕业论文\\04 系统代码\\C30 开发源代码\\前端\\jobData_Analysis前端\\node_modules\\babel-loader\\lib\\index.js!E:\\00 毕业论文\\04 系统代码\\C30 开发源代码\\前端\\jobData_Analysis前端\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\00 毕业论文\\04 系统代码\\C30 开发源代码\\前端\\jobData_Analysis前端\\src\\views\\personalcenter\\component\\echarts\\echartsSimple.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\00 毕业论文\\04 系统代码\\C30 开发源代码\\前端\\jobData_Analysis前端\\src\\views\\personalcenter\\component\\echarts\\echartsSimple.vue","mtime":1605704018746},{"path":"E:\\00 毕业论文\\04 系统代码\\C30 开发源代码\\前端\\jobData_Analysis前端\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1580901136398},{"path":"E:\\00 毕业论文\\04 系统代码\\C30 开发源代码\\前端\\jobData_Analysis前端\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\00 毕业论文\\04 系统代码\\C30 开发源代码\\前端\\jobData_Analysis前端\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.assign\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport echarts from \"echarts\";\nimport \"echarts/map/js/province/beijing\";\nimport AreaData from \"./data\";\nimport EchartsOption from \"./optionConfig\";\nexport default {\n  name: \"EchartsDemo\",\n  props: {\n    areaData: {\n      type: Array,\n      default: function _default() {\n        return new AreaData();\n      }\n    },\n    option: {\n      type: Object,\n      default: function _default() {\n        return new EchartsOption();\n      }\n    },\n    colorList: {\n      type: Array,\n      default: function _default() {\n        return [\"#F4E001\", \"#F0805A\", \"#26C0C0\"];\n      }\n    },\n    cityConfig: {\n      type: Object,\n      default: function _default() {\n        return {\n          name: \"北京市\",\n          dataJson: null\n        };\n      }\n    },\n    areaItems: {\n      type: Object,\n      default: function _default() {\n        return {\n          东城区: [116.418757, 39.937544],\n          西城区: [116.366794, 39.910309],\n          朝阳区: [116.486409, 39.991489],\n          丰台区: [116.286968, 39.863642],\n          石景山区: [116.170445, 39.974601],\n          海淀区: [116.280316, 40.039074],\n          门头沟区: [115.905381, 40.009183],\n          房山区: [115.701157, 39.735535],\n          通州区: [116.758603, 39.802486],\n          顺义区: [116.753525, 40.128936],\n          昌平区: [116.235906, 40.318085],\n          大兴区: [116.338033, 39.658908],\n          怀柔区: [116.607122, 40.524272],\n          平谷区: [117.112335, 40.244783],\n          密云区: [116.943352, 40.477362],\n          延庆区: [115.985006, 40.465325]\n        };\n      }\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.myChart.off(\"click\");\n  },\n  data: function data() {\n    return {\n      wrap: null,\n      //包裹框\n      drawBar: null,\n      // 柱状图\n      barWrap: null,\n      shaDe: null,\n      // 遮挡层\n      myChart: null,\n      // 地区坐标\n      selfAreaItems: {},\n      selfAreaData: new AreaData(),\n      selfOption: new EchartsOption()\n    };\n  },\n  mounted: function mounted() {\n    this.init();\n  },\n  methods: {\n    loadMap: function loadMap(mapName, data) {\n      if (data) {\n        console.log(mapName, data, \"mapName, datamapName, data\");\n        echarts.registerMap(mapName, data);\n      }\n    },\n    init: function init() {\n      // console.log(mapJson, \"mapJsonmapJson\");\n      this.selfAreaData = JSON.parse(JSON.stringify(this.areaData));\n      this.selfOption = JSON.parse(JSON.stringify(this.option));\n      this.selfColor = JSON.parse(JSON.stringify(this.colorList));\n      this.selfOption = JSON.parse(JSON.stringify(this.option));\n      this.myChart = echarts.init(this.$refs.myEchart);\n\n      if (this.cityConfig.dataJson) {\n        console.log(this.cityConfig);\n        this.loadMap(this.cityConfig.name, this.cityConfig.dataJson);\n      }\n\n      this.selfAreaItems = JSON.parse(JSON.stringify(this.areaItems));\n      window.onresize = this.myChart.resize;\n      this.myChart.setOption(this.selfOption); // 拖拽跟缩放重置\n\n      var throttledRenderEachCity = this.throttle(this.renderItems, 0);\n      this.myChart.on(\"geoRoam\", throttledRenderEachCity);\n      this.renderItems();\n      this.itemonClick();\n    },\n    // 缩放和拖拽\n    throttle: function throttle(fn, delay, debounce) {\n      var currCall;\n      var lastCall = 0;\n      var lastExec = 0;\n      var timer = null;\n      var diff;\n      var scope;\n      var args;\n      delay = delay || 0;\n\n      function exec() {\n        lastExec = new Date().getTime();\n        timer = null;\n        fn.apply(scope, args || []);\n      }\n\n      var cb = function cb() {\n        currCall = new Date().getTime();\n        scope = this;\n        args = arguments;\n        diff = currCall - (debounce ? lastCall : lastExec) - delay;\n        clearTimeout(timer);\n\n        if (debounce) {\n          timer = setTimeout(exec, delay);\n        } else {\n          if (diff >= 0) {\n            exec();\n          } else {\n            timer = setTimeout(exec, -diff);\n          }\n        }\n\n        lastCall = currCall;\n      };\n\n      return cb;\n    },\n    // 填充 地图点位\n    renderItems: function renderItems() {\n      var _this = this;\n\n      var option = Object.assign(this.selfOption, {\n        xAxis: [],\n        yAxis: [],\n        grid: [],\n        series: [],\n        tooltip: {\n          trigger: \"item\",\n          axisPointer: {\n            type: \"none\"\n          }\n        }\n      });\n      this.selfAreaData.forEach(function (item, idx) {\n        var nodeCoord = _this.selfAreaItems[item.areaName];\n\n        var coord = _this.myChart.convertToPixel(\"geo\", nodeCoord);\n\n        var titleItems = item.DateItems.map(function (i) {\n          return i.title;\n        });\n        var itemData = item.DateItems.map(function (i) {\n          return Number(i.value);\n        });\n        console.log(item, _this.selfAreaItems, coord);\n\n        if (coord) {\n          option.xAxis.push({\n            id: idx + item.areaName,\n            gridId: idx + item.areaName,\n            type: \"category\",\n            name: item.areaName,\n            nameLocation: \"middle\",\n            nameGap: 3,\n            splitLine: {\n              show: false\n            },\n            axisTick: {\n              show: false\n            },\n            axisLabel: {\n              show: false\n            },\n            axisLine: {\n              onZero: false,\n              lineStyle: {\n                color: \"#666\"\n              }\n            },\n            data: titleItems,\n            z: 100\n          });\n          option.yAxis.push({\n            id: idx + item.areaName,\n            gridId: idx + item.areaName,\n            type: \"value\",\n            splitLine: {\n              show: false\n            },\n            axisTick: {\n              show: false\n            },\n            axisLabel: {\n              show: false\n            },\n            axisLine: {\n              show: false,\n              lineStyle: {\n                color: \"red\"\n              }\n            },\n            min: 0,\n            max: \"dataMax\"\n          });\n          option.grid.push({\n            id: idx + item.areaName,\n            width: 30,\n            height: 40,\n            left: coord[0] - 15,\n            top: coord[1] - 15,\n            z: 100\n          });\n          option.series.push({\n            id: idx + item.areaName,\n            type: \"bar\",\n            xAxisId: idx + item.areaName,\n            yAxisId: idx + item.areaName,\n            barGap: 0,\n            barCategoryGap: 0,\n            data: itemData,\n            z: 100,\n            itemStyle: {\n              normal: {\n                color: function color(params) {\n                  // build a color map as your need.\n                  var color = _this.selfColor[params.dataIndex];\n                  return color;\n                }\n              },\n              opacity: 0,\n              emphasis: {\n                label: {\n                  show: false\n                }\n              }\n            }\n          });\n        }\n      });\n      this.myChart.setOption(option);\n    },\n    // 点击显示柱状图\n    itemonClick: function itemonClick() {\n      var _this2 = this;\n\n      this.myChart.on(\"click\", function (e) {\n        if (e.componentSubType == \"bar\") {\n          _this2.barWrap = document.createElement(\"div\");\n          _this2.drawBar = document.createElement(\"div\");\n          _this2.wrap = document.getElementsByClassName(\"wrap\")[0]; // 先清除所有柱状图\n          // $(\".tongJiTu\").remove();\n          // 创建遮挡层\n\n          _this2.creatWrap(); // 创建柱状图容器\n\n\n          _this2.barWrap.id = \"bar-wrap\";\n          _this2.barWrap.className = \"bar-wrap\";\n          _this2.drawBar.className = \"zhuzhuang\";\n\n          var divX = _this2.getMousePos()[\"x\"];\n\n          var divY = _this2.getMousePos()[\"y\"];\n\n          _this2.barWrap.setAttribute(\"style\", \"width: 350px; height: 180px;border: 1px solid #ccc;position:absolute;top: \".concat(divY, \"px;left:\").concat(divX, \"px\"));\n\n          _this2.drawBar.setAttribute(\"style\", \"width: 100%; height: 100%\"); // 创建柱状图\n\n\n          _this2.wrap.appendChild(_this2.barWrap);\n\n          _this2.barWrap.appendChild(_this2.drawBar);\n\n          _this2.zhuZhuangTu(e); // // 点击遮挡层消失\n\n\n          _this2.clearWrap();\n        }\n\n        return;\n      });\n    },\n    // 获取横纵坐标\n    getMousePos: function getMousePos(e) {\n      e = event || window.event;\n      var x = e.clientX;\n      var y = e.clientY;\n      return {\n        x: x,\n        y: y\n      };\n    },\n    // 生成柱状图\n    zhuZhuangTu: function zhuZhuangTu(e) {\n      var index = e.seriesIndex;\n      var bar = echarts.init(this.drawBar);\n      var xTitle = this.selfAreaData[index].DateItems.map(function (i) {\n        return i.title;\n      });\n      var yValue = this.selfAreaData[index].DateItems.map(function (i) {\n        return i.value;\n      });\n      var option = {\n        backgroundColor: \"rgba(255,255,255,.3)\",\n        legend: {\n          data: xTitle\n        },\n        xAxis: [{\n          type: \"category\",\n          data: xTitle\n        }],\n        yAxis: [{\n          splitLine: {\n            show: false\n          },\n          type: \"value\"\n        }],\n        series: [{\n          type: \"bar\",\n          itemStyle: {\n            normal: {\n              color: function color(params) {\n                var colorList = [\"#F75D5D\", \"#59ED4F\", \"#4C91E7\"];\n                return colorList[params.dataIndex];\n              },\n              label: {\n                show: true,\n                position: \"top\",\n                textStyle: {\n                  color: \"#000\"\n                }\n              }\n            }\n          },\n          data: yValue\n        }]\n      };\n      bar.setOption(option);\n    },\n    // 生成遮挡层\n    creatWrap: function creatWrap() {\n      this.shaDe = document.createElement(\"div\");\n      this.shaDe.className = \"shaDe\";\n      this.wrap.appendChild(this.shaDe);\n    },\n    // 去掉遮挡层\n    clearWrap: function clearWrap() {\n      var _this3 = this;\n\n      this.shaDe.addEventListener(\"click\", function () {\n        _this3.shaDe.remove();\n\n        _this3.barWrap.remove();\n\n        _this3.drawBar.remove();\n\n        return false;\n      }, false);\n    }\n  }\n};",{"version":3,"sources":["echartsSimple.vue"],"names":[],"mappings":";;;;;;;;;;;;;;AAWA,OAAA,OAAA,MAAA,SAAA;AACA,OAAA,iCAAA;AACA,OAAA,QAAA,MAAA,QAAA;AACA,OAAA,aAAA,MAAA,gBAAA;AACA,eAAA;AACA,QAAA,aADA;AAEA,SAAA;AACA,cAAA;AACA,YAAA,KADA;AAEA,aAFA,sBAEA;AACA,eAAA,IAAA,QAAA,EAAA;AACA;AAJA,KADA;AAOA,YAAA;AACA,YAAA,MADA;AAEA,aAFA,sBAEA;AACA,eAAA,IAAA,aAAA,EAAA;AACA;AAJA,KAPA;AAaA,eAAA;AACA,YAAA,KADA;AAEA,aAFA,sBAEA;AACA,eAAA,CAAA,SAAA,EAAA,SAAA,EAAA,SAAA,CAAA;AACA;AAJA,KAbA;AAmBA,gBAAA;AACA,YAAA,MADA;AAEA,aAFA,sBAEA;AACA,eAAA;AACA,gBAAA,KADA;AAEA,oBAAA;AAFA,SAAA;AAIA;AAPA,KAnBA;AA4BA,eAAA;AACA,YAAA,MADA;AAEA,aAFA,sBAEA;AACA,eAAA;AACA,eAAA,CAAA,UAAA,EAAA,SAAA,CADA;AAEA,eAAA,CAAA,UAAA,EAAA,SAAA,CAFA;AAGA,eAAA,CAAA,UAAA,EAAA,SAAA,CAHA;AAIA,eAAA,CAAA,UAAA,EAAA,SAAA,CAJA;AAKA,gBAAA,CAAA,UAAA,EAAA,SAAA,CALA;AAMA,eAAA,CAAA,UAAA,EAAA,SAAA,CANA;AAOA,gBAAA,CAAA,UAAA,EAAA,SAAA,CAPA;AAQA,eAAA,CAAA,UAAA,EAAA,SAAA,CARA;AASA,eAAA,CAAA,UAAA,EAAA,SAAA,CATA;AAUA,eAAA,CAAA,UAAA,EAAA,SAAA,CAVA;AAWA,eAAA,CAAA,UAAA,EAAA,SAAA,CAXA;AAYA,eAAA,CAAA,UAAA,EAAA,SAAA,CAZA;AAaA,eAAA,CAAA,UAAA,EAAA,SAAA,CAbA;AAcA,eAAA,CAAA,UAAA,EAAA,SAAA,CAdA;AAeA,eAAA,CAAA,UAAA,EAAA,SAAA,CAfA;AAgBA,eAAA,CAAA,UAAA,EAAA,SAAA;AAhBA,SAAA;AAkBA;AArBA;AA5BA,GAFA;AAsDA,eAtDA,2BAsDA;AACA,SAAA,OAAA,CAAA,GAAA,CAAA,OAAA;AACA,GAxDA;AAyDA,MAzDA,kBAyDA;AACA,WAAA;AACA,YAAA,IADA;AACA;AACA,eAAA,IAFA;AAEA;AACA,eAAA,IAHA;AAIA,aAAA,IAJA;AAIA;AACA,eAAA,IALA;AAMA;AACA,qBAAA,EAPA;AAQA,oBAAA,IAAA,QAAA,EARA;AASA,kBAAA,IAAA,aAAA;AATA,KAAA;AAWA,GArEA;AAuEA,SAvEA,qBAuEA;AACA,SAAA,IAAA;AACA,GAzEA;AA0EA,WAAA;AACA,WADA,mBACA,OADA,EACA,IADA,EACA;AACA,UAAA,IAAA,EAAA;AACA,gBAAA,GAAA,CAAA,OAAA,EAAA,IAAA,EAAA,4BAAA;AACA,gBAAA,WAAA,CAAA,OAAA,EAAA,IAAA;AACA;AACA,KANA;AAOA,QAPA,kBAOA;AACA;AAEA,WAAA,YAAA,GAAA,KAAA,KAAA,CAAA,KAAA,SAAA,CAAA,KAAA,QAAA,CAAA,CAAA;AACA,WAAA,UAAA,GAAA,KAAA,KAAA,CAAA,KAAA,SAAA,CAAA,KAAA,MAAA,CAAA,CAAA;AACA,WAAA,SAAA,GAAA,KAAA,KAAA,CAAA,KAAA,SAAA,CAAA,KAAA,SAAA,CAAA,CAAA;AACA,WAAA,UAAA,GAAA,KAAA,KAAA,CAAA,KAAA,SAAA,CAAA,KAAA,MAAA,CAAA,CAAA;AACA,WAAA,OAAA,GAAA,QAAA,IAAA,CAAA,KAAA,KAAA,CAAA,QAAA,CAAA;;AACA,UAAA,KAAA,UAAA,CAAA,QAAA,EAAA;AACA,gBAAA,GAAA,CAAA,KAAA,UAAA;AACA,aAAA,OAAA,CAAA,KAAA,UAAA,CAAA,IAAA,EAAA,KAAA,UAAA,CAAA,QAAA;AACA;;AACA,WAAA,aAAA,GAAA,KAAA,KAAA,CAAA,KAAA,SAAA,CAAA,KAAA,SAAA,CAAA,CAAA;AACA,aAAA,QAAA,GAAA,KAAA,OAAA,CAAA,MAAA;AAEA,WAAA,OAAA,CAAA,SAAA,CAAA,KAAA,UAAA,EAfA,CAgBA;;AACA,UAAA,0BAAA,KAAA,QAAA,CAAA,KAAA,WAAA,EAAA,CAAA,CAAA;AACA,WAAA,OAAA,CAAA,EAAA,CAAA,SAAA,EAAA,uBAAA;AACA,WAAA,WAAA;AACA,WAAA,WAAA;AACA,KA5BA;AA6BA;AACA,YA9BA,oBA8BA,EA9BA,EA8BA,KA9BA,EA8BA,QA9BA,EA8BA;AACA,UAAA,QAAA;AACA,UAAA,WAAA,CAAA;AACA,UAAA,WAAA,CAAA;AACA,UAAA,QAAA,IAAA;AACA,UAAA,IAAA;AACA,UAAA,KAAA;AACA,UAAA,IAAA;AACA,cAAA,SAAA,CAAA;;AACA,eAAA,IAAA,GAAA;AACA,mBAAA,IAAA,IAAA,GAAA,OAAA,EAAA;AACA,gBAAA,IAAA;AACA,WAAA,KAAA,CAAA,KAAA,EAAA,QAAA,EAAA;AACA;;AAEA,UAAA,KAAA,SAAA,EAAA,GAAA;AACA,mBAAA,IAAA,IAAA,GAAA,OAAA,EAAA;AACA,gBAAA,IAAA;AACA,eAAA,SAAA;AACA,eAAA,YAAA,WAAA,QAAA,GAAA,QAAA,IAAA,KAAA;AAEA,qBAAA,KAAA;;AAEA,YAAA,QAAA,EAAA;AACA,kBAAA,WAAA,IAAA,EAAA,KAAA,CAAA;AACA,SAFA,MAEA;AACA,cAAA,QAAA,CAAA,EAAA;AACA;AACA,WAFA,MAEA;AACA,oBAAA,WAAA,IAAA,EAAA,CAAA,IAAA,CAAA;AACA;AACA;;AAEA,mBAAA,QAAA;AACA,OAnBA;;AAqBA,aAAA,EAAA;AACA,KAnEA;AAoEA;AACA,eArEA,yBAqEA;AAAA;;AACA,UAAA,SAAA,OAAA,MAAA,CAAA,KAAA,UAAA,EAAA;AACA,eAAA,EADA;AAEA,eAAA,EAFA;AAGA,cAAA,EAHA;AAIA,gBAAA,EAJA;AAKA,iBAAA;AACA,mBAAA,MADA;AAEA,uBAAA;AACA,kBAAA;AADA;AAFA;AALA,OAAA,CAAA;AAYA,WAAA,YAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA,GAAA,EAAA;AACA,YAAA,YAAA,MAAA,aAAA,CAAA,KAAA,QAAA,CAAA;;AACA,YAAA,QAAA,MAAA,OAAA,CAAA,cAAA,CAAA,KAAA,EAAA,SAAA,CAAA;;AACA,YAAA,aAAA,KAAA,SAAA,CAAA,GAAA,CAAA;AAAA,iBAAA,EAAA,KAAA;AAAA,SAAA,CAAA;AACA,YAAA,WAAA,KAAA,SAAA,CAAA,GAAA,CAAA;AAAA,iBAAA,OAAA,EAAA,KAAA,CAAA;AAAA,SAAA,CAAA;AACA,gBAAA,GAAA,CAAA,IAAA,EAAA,MAAA,aAAA,EAAA,KAAA;;AACA,YAAA,KAAA,EAAA;AACA,iBAAA,KAAA,CAAA,IAAA,CAAA;AACA,gBAAA,MAAA,KAAA,QADA;AAEA,oBAAA,MAAA,KAAA,QAFA;AAGA,kBAAA,UAHA;AAIA,kBAAA,KAAA,QAJA;AAKA,0BAAA,QALA;AAMA,qBAAA,CANA;AAOA,uBAAA;AACA,oBAAA;AADA,aAPA;AAUA,sBAAA;AACA,oBAAA;AADA,aAVA;AAaA,uBAAA;AACA,oBAAA;AADA,aAbA;AAgBA,sBAAA;AACA,sBAAA,KADA;AAEA,yBAAA;AACA,uBAAA;AADA;AAFA,aAhBA;AAsBA,kBAAA,UAtBA;AAuBA,eAAA;AAvBA,WAAA;AAyBA,iBAAA,KAAA,CAAA,IAAA,CAAA;AACA,gBAAA,MAAA,KAAA,QADA;AAEA,oBAAA,MAAA,KAAA,QAFA;AAGA,kBAAA,OAHA;AAIA,uBAAA;AACA,oBAAA;AADA,aAJA;AAOA,sBAAA;AACA,oBAAA;AADA,aAPA;AAUA,uBAAA;AACA,oBAAA;AADA,aAVA;AAaA,sBAAA;AACA,oBAAA,KADA;AAEA,yBAAA;AACA,uBAAA;AADA;AAFA,aAbA;AAmBA,iBAAA,CAnBA;AAoBA,iBAAA;AApBA,WAAA;AAsBA,iBAAA,IAAA,CAAA,IAAA,CAAA;AACA,gBAAA,MAAA,KAAA,QADA;AAEA,mBAAA,EAFA;AAGA,oBAAA,EAHA;AAIA,kBAAA,MAAA,CAAA,IAAA,EAJA;AAKA,iBAAA,MAAA,CAAA,IAAA,EALA;AAMA,eAAA;AANA,WAAA;AAQA,iBAAA,MAAA,CAAA,IAAA,CAAA;AACA,gBAAA,MAAA,KAAA,QADA;AAEA,kBAAA,KAFA;AAGA,qBAAA,MAAA,KAAA,QAHA;AAIA,qBAAA,MAAA,KAAA,QAJA;AAKA,oBAAA,CALA;AAMA,4BAAA,CANA;AAOA,kBAAA,QAPA;AAQA,eAAA,GARA;AASA,uBAAA;AACA,sBAAA;AACA,uBAAA,uBAAA;AACA;AACA,sBAAA,QAAA,MAAA,SAAA,CAAA,OAAA,SAAA,CAAA;AACA,yBAAA,KAAA;AACA;AALA,eADA;AAQA,uBAAA,CARA;AASA,wBAAA;AACA,uBAAA;AACA,wBAAA;AADA;AADA;AATA;AATA,WAAA;AAyBA;AACA,OAxFA;AAyFA,WAAA,OAAA,CAAA,SAAA,CAAA,MAAA;AACA,KA5KA;AA6KA;AACA,eA9KA,yBA8KA;AAAA;;AACA,WAAA,OAAA,CAAA,EAAA,CAAA,OAAA,EAAA,aAAA;AACA,YAAA,EAAA,gBAAA,IAAA,KAAA,EAAA;AACA,iBAAA,OAAA,GAAA,SAAA,aAAA,CAAA,KAAA,CAAA;AACA,iBAAA,OAAA,GAAA,SAAA,aAAA,CAAA,KAAA,CAAA;AACA,iBAAA,IAAA,GAAA,SAAA,sBAAA,CAAA,MAAA,EAAA,CAAA,CAAA,CAHA,CAIA;AACA;AACA;;AACA,iBAAA,SAAA,GAPA,CAQA;;;AACA,iBAAA,OAAA,CAAA,EAAA,GAAA,UAAA;AACA,iBAAA,OAAA,CAAA,SAAA,GAAA,UAAA;AACA,iBAAA,OAAA,CAAA,SAAA,GAAA,WAAA;;AACA,cAAA,OAAA,OAAA,WAAA,GAAA,GAAA,CAAA;;AACA,cAAA,OAAA,OAAA,WAAA,GAAA,GAAA,CAAA;;AACA,iBAAA,OAAA,CAAA,YAAA,CACA,OADA,sFAEA,IAFA,qBAEA,IAFA;;AAIA,iBAAA,OAAA,CAAA,YAAA,CAAA,OAAA,+BAlBA,CAmBA;;;AACA,iBAAA,IAAA,CAAA,WAAA,CAAA,OAAA,OAAA;;AACA,iBAAA,OAAA,CAAA,WAAA,CAAA,OAAA,OAAA;;AACA,iBAAA,WAAA,CAAA,CAAA,EAtBA,CAuBA;;;AACA,iBAAA,SAAA;AACA;;AACA;AACA,OA5BA;AA6BA,KA5MA;AA6MA;AACA,eA9MA,uBA8MA,CA9MA,EA8MA;AACA,UAAA,SAAA,OAAA,KAAA;AACA,UAAA,IAAA,EAAA,OAAA;AACA,UAAA,IAAA,EAAA,OAAA;AACA,aAAA;AAAA,YAAA;AAAA;AAAA,OAAA;AACA,KAnNA;AAoNA;AACA,eArNA,uBAqNA,CArNA,EAqNA;AACA,UAAA,QAAA,EAAA,WAAA;AACA,UAAA,MAAA,QAAA,IAAA,CAAA,KAAA,OAAA,CAAA;AACA,UAAA,SAAA,KAAA,YAAA,CAAA,KAAA,EAAA,SAAA,CAAA,GAAA,CAAA;AAAA,eAAA,EAAA,KAAA;AAAA,OAAA,CAAA;AACA,UAAA,SAAA,KAAA,YAAA,CAAA,KAAA,EAAA,SAAA,CAAA,GAAA,CAAA;AAAA,eAAA,EAAA,KAAA;AAAA,OAAA,CAAA;AACA,UAAA,SAAA;AACA,yBAAA,sBADA;AAEA,gBAAA;AACA,gBAAA;AADA,SAFA;AAKA,eAAA,CACA;AACA,gBAAA,UADA;AAEA,gBAAA;AAFA,SADA,CALA;AAWA,eAAA,CACA;AACA,qBAAA;AACA,kBAAA;AADA,WADA;AAIA,gBAAA;AAJA,SADA,CAXA;AAmBA,gBAAA,CACA;AACA,gBAAA,KADA;AAEA,qBAAA;AACA,oBAAA;AACA,qBAAA,eAAA,MAAA,EAAA;AACA,oBAAA,YAAA,CAAA,SAAA,EAAA,SAAA,EAAA,SAAA,CAAA;AACA,uBAAA,UAAA,OAAA,SAAA,CAAA;AACA,eAJA;AAKA,qBAAA;AACA,sBAAA,IADA;AAEA,0BAAA,KAFA;AAGA,2BAAA;AACA,yBAAA;AADA;AAHA;AALA;AADA,WAFA;AAiBA,gBAAA;AAjBA,SADA;AAnBA,OAAA;AAyCA,UAAA,SAAA,CAAA,MAAA;AACA,KApQA;AAqQA;AACA,aAtQA,uBAsQA;AACA,WAAA,KAAA,GAAA,SAAA,aAAA,CAAA,KAAA,CAAA;AACA,WAAA,KAAA,CAAA,SAAA,GAAA,OAAA;AACA,WAAA,IAAA,CAAA,WAAA,CAAA,KAAA,KAAA;AACA,KA1QA;AA2QA;AACA,aA5QA,uBA4QA;AAAA;;AACA,WAAA,KAAA,CAAA,gBAAA,CACA,OADA,EAEA,YAAA;AACA,eAAA,KAAA,CAAA,MAAA;;AACA,eAAA,OAAA,CAAA,MAAA;;AACA,eAAA,OAAA,CAAA,MAAA;;AACA,eAAA,KAAA;AACA,OAPA,EAQA,KARA;AAUA;AAvRA;AA1EA,CAAA","sourcesContent":["<template>\n  <div class=\"echartDemo\">\n    <div class=\"wrap\">\n      <div id=\"map\" style=\"width: 100%; height: 800px;\">\n        <div :style=\"{ height: '400px', width: '100%' }\" ref=\"myEchart\"></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport echarts from \"echarts\";\nimport \"echarts/map/js/province/beijing\";\nimport AreaData from \"./data\";\nimport EchartsOption from \"./optionConfig\";\nexport default {\n  name: \"EchartsDemo\",\n  props: {\n    areaData: {\n      type: Array,\n      default() {\n        return new AreaData();\n      }\n    },\n    option: {\n      type: Object,\n      default() {\n        return new EchartsOption();\n      }\n    },\n    colorList: {\n      type: Array,\n      default() {\n        return [\"#F4E001\", \"#F0805A\", \"#26C0C0\"];\n      }\n    },\n    cityConfig: {\n      type: Object,\n      default() {\n        return {\n          name: \"北京市\",\n          dataJson: null\n        };\n      }\n    },\n    areaItems: {\n      type: Object,\n      default() {\n        return {\n          东城区: [116.418757, 39.937544],\n          西城区: [116.366794, 39.910309],\n          朝阳区: [116.486409, 39.991489],\n          丰台区: [116.286968, 39.863642],\n          石景山区: [116.170445, 39.974601],\n          海淀区: [116.280316, 40.039074],\n          门头沟区: [115.905381, 40.009183],\n          房山区: [115.701157, 39.735535],\n          通州区: [116.758603, 39.802486],\n          顺义区: [116.753525, 40.128936],\n          昌平区: [116.235906, 40.318085],\n          大兴区: [116.338033, 39.658908],\n          怀柔区: [116.607122, 40.524272],\n          平谷区: [117.112335, 40.244783],\n          密云区: [116.943352, 40.477362],\n          延庆区: [115.985006, 40.465325]\n        };\n      }\n    }\n  },\n  beforeDestroy() {\n    this.myChart.off(\"click\");\n  },\n  data() {\n    return {\n      wrap: null, //包裹框\n      drawBar: null, // 柱状图\n      barWrap: null,\n      shaDe: null, // 遮挡层\n      myChart: null,\n      // 地区坐标\n      selfAreaItems: {},\n      selfAreaData: new AreaData(),\n      selfOption: new EchartsOption()\n    };\n  },\n\n  mounted() {\n    this.init();\n  },\n  methods: {\n    loadMap(mapName, data) {\r\n      if (data) {\r\n        console.log(mapName, data, \"mapName, datamapName, data\");\r\n        echarts.registerMap(mapName, data);\r\n      }\r\n    },\r\n    init() {\r\n      // console.log(mapJson, \"mapJsonmapJson\");\r\n    \r\n      this.selfAreaData = JSON.parse(JSON.stringify(this.areaData));\r\n      this.selfOption = JSON.parse(JSON.stringify(this.option));\r\n      this.selfColor = JSON.parse(JSON.stringify(this.colorList));\r\n      this.selfOption = JSON.parse(JSON.stringify(this.option));\r\n      this.myChart = echarts.init(this.$refs.myEchart);\r\n      if (this.cityConfig.dataJson) {\r\n        console.log(this.cityConfig);\r\n        this.loadMap(this.cityConfig.name, this.cityConfig.dataJson);\r\n      }\r\n      this.selfAreaItems = JSON.parse(JSON.stringify(this.areaItems));\r\n      window.onresize = this.myChart.resize;\r\n    \r\n      this.myChart.setOption(this.selfOption);\r\n      // 拖拽跟缩放重置\r\n      let throttledRenderEachCity = this.throttle(this.renderItems, 0);\r\n      this.myChart.on(\"geoRoam\", throttledRenderEachCity);\r\n      this.renderItems();\r\n      this.itemonClick();\r\n    },\r\n    // 缩放和拖拽\r\n    throttle(fn, delay, debounce) {\r\n      let currCall;\r\n      let lastCall = 0;\r\n      let lastExec = 0;\r\n      let timer = null;\r\n      let diff;\r\n      let scope;\r\n      let args;\r\n      delay = delay || 0;\r\n      function exec() {\r\n        lastExec = new Date().getTime();\r\n        timer = null;\r\n        fn.apply(scope, args || []);\r\n      }\r\n    \r\n      let cb = function() {\r\n        currCall = new Date().getTime();\r\n        scope = this;\r\n        args = arguments;\r\n        diff = currCall - (debounce ? lastCall : lastExec) - delay;\r\n    \r\n        clearTimeout(timer);\r\n    \r\n        if (debounce) {\r\n          timer = setTimeout(exec, delay);\r\n        } else {\r\n          if (diff >= 0) {\r\n            exec();\r\n          } else {\r\n            timer = setTimeout(exec, -diff);\r\n          }\r\n        }\r\n    \r\n        lastCall = currCall;\r\n      };\r\n    \r\n      return cb;\r\n    },\r\n    // 填充 地图点位\r\n    renderItems() {\r\n      let option = Object.assign(this.selfOption, {\r\n        xAxis: [],\r\n        yAxis: [],\r\n        grid: [],\r\n        series: [],\r\n        tooltip: {\r\n          trigger: \"item\",\r\n          axisPointer: {\r\n            type: \"none\"\r\n          }\r\n        }\r\n      });\r\n      this.selfAreaData.forEach((item, idx) => {\r\n        let nodeCoord = this.selfAreaItems[item.areaName];\r\n        let coord = this.myChart.convertToPixel(\"geo\", nodeCoord);\r\n        let titleItems = item.DateItems.map(i => i.title);\r\n        let itemData = item.DateItems.map(i => Number(i.value));\r\n        console.log(item, this.selfAreaItems, coord);\r\n        if (coord) {\r\n          option.xAxis.push({\r\n            id: idx + item.areaName,\r\n            gridId: idx + item.areaName,\r\n            type: \"category\",\r\n            name: item.areaName,\r\n            nameLocation: \"middle\",\r\n            nameGap: 3,\r\n            splitLine: {\r\n              show: false\r\n            },\r\n            axisTick: {\r\n              show: false\r\n            },\r\n            axisLabel: {\r\n              show: false\r\n            },\r\n            axisLine: {\r\n              onZero: false,\r\n              lineStyle: {\r\n                color: \"#666\"\r\n              }\r\n            },\r\n            data: titleItems,\r\n            z: 100\r\n          });\r\n          option.yAxis.push({\r\n            id: idx + item.areaName,\r\n            gridId: idx + item.areaName,\r\n            type: \"value\",\r\n            splitLine: {\r\n              show: false\r\n            },\r\n            axisTick: {\r\n              show: false\r\n            },\r\n            axisLabel: {\r\n              show: false\r\n            },\r\n            axisLine: {\r\n              show: false,\r\n              lineStyle: {\r\n                color: \"red\"\r\n              }\r\n            },\r\n            min: 0,\r\n            max: \"dataMax\"\r\n          });\r\n          option.grid.push({\r\n            id: idx + item.areaName,\r\n            width: 30,\r\n            height: 40,\r\n            left: coord[0] - 15,\r\n            top: coord[1] - 15,\r\n            z: 100\r\n          });\r\n          option.series.push({\r\n            id: idx + item.areaName,\r\n            type: \"bar\",\r\n            xAxisId: idx + item.areaName,\r\n            yAxisId: idx + item.areaName,\r\n            barGap: 0,\r\n            barCategoryGap: 0,\r\n            data: itemData,\r\n            z: 100,\r\n            itemStyle: {\r\n              normal: {\r\n                color: params => {\r\n                  // build a color map as your need.\r\n                  let color = this.selfColor[params.dataIndex];\r\n                  return color;\r\n                }\r\n              },\r\n              opacity: 0,\r\n              emphasis: {\r\n                label: {\r\n                  show: false\r\n                }\r\n              }\r\n            }\r\n          });\r\n        }\r\n      });\r\n      this.myChart.setOption(option);\r\n    },\r\n    // 点击显示柱状图\r\n    itemonClick() {\r\n      this.myChart.on(\"click\", e => {\r\n        if (e.componentSubType == \"bar\") {\r\n          this.barWrap = document.createElement(\"div\");\r\n          this.drawBar = document.createElement(\"div\");\r\n          this.wrap = document.getElementsByClassName(\"wrap\")[0];\r\n          // 先清除所有柱状图\r\n          // $(\".tongJiTu\").remove();\r\n          // 创建遮挡层\r\n          this.creatWrap();\r\n          // 创建柱状图容器\r\n          this.barWrap.id = \"bar-wrap\";\r\n          this.barWrap.className = \"bar-wrap\";\r\n          this.drawBar.className = \"zhuzhuang\";\r\n          let divX = this.getMousePos()[\"x\"];\r\n          let divY = this.getMousePos()[\"y\"];\r\n          this.barWrap.setAttribute(\r\n            \"style\",\r\n            `width: 350px; height: 180px;border: 1px solid #ccc;position:absolute;top: ${divY}px;left:${divX}px`\r\n          );\r\n          this.drawBar.setAttribute(\"style\", `width: 100%; height: 100%`);\r\n          // 创建柱状图\r\n          this.wrap.appendChild(this.barWrap);\r\n          this.barWrap.appendChild(this.drawBar);\r\n          this.zhuZhuangTu(e);\r\n          // // 点击遮挡层消失\r\n          this.clearWrap();\r\n        }\r\n        return;\r\n      });\r\n    },\r\n    // 获取横纵坐标\r\n    getMousePos(e) {\r\n      e = event || window.event;\r\n      let x = e.clientX;\r\n      let y = e.clientY;\r\n      return { x, y };\r\n    },\r\n    // 生成柱状图\r\n    zhuZhuangTu(e) {\r\n      let index = e.seriesIndex;\r\n      let bar = echarts.init(this.drawBar);\r\n      let xTitle = this.selfAreaData[index].DateItems.map(i => i.title);\r\n      let yValue = this.selfAreaData[index].DateItems.map(i => i.value);\r\n      let option = {\r\n        backgroundColor: \"rgba(255,255,255,.3)\",\r\n        legend: {\r\n          data: xTitle\r\n        },\r\n        xAxis: [\r\n          {\r\n            type: \"category\",\r\n            data: xTitle\r\n          }\r\n        ],\r\n        yAxis: [\r\n          {\r\n            splitLine: {\r\n              show: false\r\n            },\r\n            type: \"value\"\r\n          }\r\n        ],\r\n        series: [\r\n          {\r\n            type: \"bar\",\r\n            itemStyle: {\r\n              normal: {\r\n                color: function(params) {\r\n                  let colorList = [\"#F75D5D\", \"#59ED4F\", \"#4C91E7\"];\r\n                  return colorList[params.dataIndex];\r\n                },\r\n                label: {\r\n                  show: true,\r\n                  position: \"top\",\r\n                  textStyle: {\r\n                    color: \"#000\"\r\n                  }\r\n                }\r\n              }\r\n            },\r\n            data: yValue\r\n          }\r\n        ]\r\n      };\r\n      bar.setOption(option);\r\n    },\r\n    // 生成遮挡层\r\n    creatWrap() {\r\n      this.shaDe = document.createElement(\"div\");\r\n      this.shaDe.className = \"shaDe\";\r\n      this.wrap.appendChild(this.shaDe);\r\n    },\r\n    // 去掉遮挡层\r\n    clearWrap() {\r\n      this.shaDe.addEventListener(\r\n        \"click\",\r\n        () => {\r\n          this.shaDe.remove();\r\n          this.barWrap.remove();\r\n          this.drawBar.remove();\r\n          return false;\r\n        },\r\n        false\r\n      );\r\n    }\n  }\n};\n</script>\n\n<style lang=\"less\">\n.shaDe {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  background-color: rgba(0, 0, 0, 0.2);\n}\n</style>\n"],"sourceRoot":"src\\views\\personalcenter\\component\\echarts"}]}